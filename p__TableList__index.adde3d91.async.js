"use strict";(self.webpackChunkflowline_admin=self.webpackChunkflowline_admin||[]).push([[325],{64317:function(ee,Z,a){var g=a(1413),E=a(44925),C=a(85893),v=a(22270),b=a(67294),h=a(66758),j=a(2123),f=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],R=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],o=b.forwardRef(function(i,Q){var L=i.fieldProps,X=i.children,O=i.params,G=i.proFieldProps,A=i.mode,V=i.valueEnum,B=i.request,z=i.showSearch,I=i.options,Y=(0,E.Z)(i,f),W=(0,b.useContext)(h.Z);return(0,C.jsx)(j.Z,(0,g.Z)((0,g.Z)({valueEnum:(0,v.h)(V),request:B,params:O,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,g.Z)({options:I,mode:A,showSearch:z,getPopupContainer:W.getPopupContainer},L),ref:Q,proFieldProps:G},Y),{},{children:X}))}),u=b.forwardRef(function(i,Q){var L=i.fieldProps,X=i.children,O=i.params,G=i.proFieldProps,A=i.mode,V=i.valueEnum,B=i.request,z=i.options,I=(0,E.Z)(i,R),Y=(0,g.Z)({options:z,mode:A||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},L),W=(0,b.useContext)(h.Z);return(0,C.jsx)(j.Z,(0,g.Z)((0,g.Z)({valueEnum:(0,v.h)(V),request:B,params:O,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,g.Z)({getPopupContainer:W.getPopupContainer},Y),ref:Q,proFieldProps:G},I),{},{children:X}))}),F=o,M=u,D=F;D.SearchSelect=M,D.displayName="ProFormComponent",Z.Z=D},5966:function(ee,Z,a){var g=a(1413),E=a(44925),C=a(85893),v=a(2123),b=["fieldProps","proFieldProps"],h=["fieldProps","proFieldProps"],j="text",f=function(F){var M=F.fieldProps,D=F.proFieldProps,i=(0,E.Z)(F,b);return(0,C.jsx)(v.Z,(0,g.Z)({valueType:j,fieldProps:M,filedConfig:{valueType:j},proFieldProps:D},i))},R=function(F){var M=F.fieldProps,D=F.proFieldProps,i=(0,E.Z)(F,h);return(0,C.jsx)(v.Z,(0,g.Z)({valueType:"password",fieldProps:M,proFieldProps:D,filedConfig:{valueType:j}},i))},o=f;o.Password=R,o.displayName="ProFormComponent",Z.Z=o},90672:function(ee,Z,a){var g=a(1413),E=a(44925),C=a(85893),v=a(67294),b=a(2123),h=["fieldProps","proFieldProps"],j=function(R,o){var u=R.fieldProps,F=R.proFieldProps,M=(0,E.Z)(R,h);return(0,C.jsx)(b.Z,(0,g.Z)({ref:o,valueType:"textarea",fieldProps:u,proFieldProps:F},M))};Z.Z=v.forwardRef(j)},66211:function(ee,Z,a){a.r(Z),a.d(Z,{default:function(){return Ve}});var g=a(56307),E=a.n(g),C=a(80164),v=a.n(C),b=a(74411),h=a.n(b),j=a(55559),f=a.n(j),R=a(45223),o=a.n(R),u=a(95952);function F(t){return M.apply(this,arguments)}function M(){return M=_asyncToGenerator(_regeneratorRuntime.mark(function t(l){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/currentUser",_objectSpread({method:"GET"},l||{})));case 1:case"end":return r.stop()}},t)})),M.apply(this,arguments)}function D(t){return i.apply(this,arguments)}function i(){return i=_asyncToGenerator(_regeneratorRuntime.mark(function t(l){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/login/outLogin",_objectSpread({method:"POST"},l||{})));case 1:case"end":return r.stop()}},t)})),i.apply(this,arguments)}function Q(t,l){return L.apply(this,arguments)}function L(){return L=_asyncToGenerator(_regeneratorRuntime.mark(function t(l,s){return _regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",request("/api/login/account",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:l},s||{})));case 1:case"end":return d.stop()}},t)})),L.apply(this,arguments)}function X(t){return O.apply(this,arguments)}function O(){return O=_asyncToGenerator(_regeneratorRuntime.mark(function t(l){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/notices",_objectSpread({method:"GET"},l||{})));case 1:case"end":return r.stop()}},t)})),O.apply(this,arguments)}function G(t,l){return A.apply(this,arguments)}function A(){return A=f()(o().mark(function t(l,s){return o().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,u.request)("/api/rule",h()({method:"GET",params:h()({},l)},s||{})));case 1:case"end":return d.stop()}},t)})),A.apply(this,arguments)}function V(t){return B.apply(this,arguments)}function B(){return B=f()(o().mark(function t(l){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,u.request)("/api/rule",h()({method:"PUT"},l||{})));case 1:case"end":return r.stop()}},t)})),B.apply(this,arguments)}function z(t){return I.apply(this,arguments)}function I(){return I=f()(o().mark(function t(l){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,u.request)("/api/rule",h()({method:"POST"},l||{})));case 1:case"end":return r.stop()}},t)})),I.apply(this,arguments)}function Y(t){return W.apply(this,arguments)}function W(){return W=f()(o().mark(function t(l){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,u.request)("/api/rule",h()({method:"DELETE"},l||{})));case 1:case"end":return r.stop()}},t)})),W.apply(this,arguments)}var Fe=a(49101),se=a(48705),Me=a(51851),Te=a(20761),ne=a(5966),le=a(90672),be=a(60415),S=a(48086),je=a(4107),ae=a(71577),xe=a(25084),x=a(67294),k=a(43110),re=a(64317),Je=a(99542),ue=a(47933),U=a(1413),oe=a(44925),e=a(85893),ye=a(22270),Ee=a(64893),ie=a(2123),Ce=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],Re=x.forwardRef(function(t,l){var s=t.fieldProps,r=t.options,d=t.radioType,n=t.layout,$=t.proFieldProps,te=t.valueEnum,H=(0,oe.Z)(t,Ce);return(0,e.jsx)(ie.Z,(0,U.Z)((0,U.Z)({valueType:d==="button"?"radioButton":"radio",ref:l,valueEnum:(0,ye.h)(te,void 0)},H),{},{fieldProps:(0,U.Z)({options:r,layout:n},s),proFieldProps:$,filedConfig:{customLightMode:!0}}))}),Se=x.forwardRef(function(t,l){var s=t.fieldProps,r=t.children;return(0,e.jsx)(ue.ZP,(0,U.Z)((0,U.Z)({},s),{},{ref:l,children:r}))}),Ze=(0,Ee.G)(Se,{valuePropName:"checked",ignoreWidth:!0}),q=Ze;q.Group=Re,q.Button=ue.ZP.Button,q.displayName="ProFormComponent";var De=q,we=a(66758),Le=["fieldProps","proFieldProps"],de="dateTime",Oe=x.forwardRef(function(t,l){var s=t.fieldProps,r=t.proFieldProps,d=(0,oe.Z)(t,Le),n=(0,x.useContext)(we.Z);return(0,e.jsx)(ie.Z,(0,U.Z)({ref:l,fieldProps:(0,U.Z)({getPopupContainer:n.getPopupContainer},s),valueType:de,proFieldProps:r,filedConfig:{valueType:de,customLightMode:!0}},d))}),Ae=Oe,Be=a(50146),Ie=function(l){var s=(0,u.useIntl)();return(0,e.jsxs)(k.L,{stepsProps:{size:"small"},stepsFormRender:function(d,n){return(0,e.jsx)(Be.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:s.formatMessage({id:"pages.searchTable.updateForm.ruleConfig",defaultMessage:"\u89C4\u5219\u914D\u7F6E"}),visible:l.updateModalVisible,footer:n,onCancel:function(){l.onCancel()},children:d})},onFinish:l.onSubmit,children:[(0,e.jsxs)(k.L.StepForm,{initialValues:{name:l.values.name,desc:l.values.desc},title:s.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),children:[(0,e.jsx)(ne.Z,{name:"name",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"\u89C4\u5219\u540D\u79F0"}),width:"md",rules:[{required:!0,message:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.updateForm.ruleName.nameRules",defaultMessage:"\u8BF7\u8F93\u5165\u89C4\u5219\u540D\u79F0\uFF01"})}]}),(0,e.jsx)(le.Z,{name:"desc",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descLabel",defaultMessage:"\u89C4\u5219\u63CF\u8FF0"}),placeholder:s.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descPlaceholder",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26"}),rules:[{required:!0,message:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.updateForm.ruleDesc.descRules",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01"}),min:5}]})]}),(0,e.jsxs)(k.L.StepForm,{initialValues:{target:"0",template:"0"},title:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.title",defaultMessage:"\u914D\u7F6E\u89C4\u5219\u5C5E\u6027"}),children:[(0,e.jsx)(re.Z,{name:"target",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"\u76D1\u63A7\u5BF9\u8C61"}),valueEnum:{0:"\u8868\u4E00",1:"\u8868\u4E8C"}}),(0,e.jsx)(re.Z,{name:"template",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.templateLabel",defaultMessage:"\u89C4\u5219\u6A21\u677F"}),valueEnum:{0:"\u89C4\u5219\u6A21\u677F\u4E00",1:"\u89C4\u5219\u6A21\u677F\u4E8C"}}),(0,e.jsx)(De.Group,{name:"type",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.typeLabel",defaultMessage:"\u89C4\u5219\u7C7B\u578B"}),options:[{value:"0",label:"\u5F3A"},{value:"1",label:"\u5F31"}]})]}),(0,e.jsxs)(k.L.StepForm,{initialValues:{type:"1",frequency:"month"},title:s.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.title",defaultMessage:"\u8BBE\u5B9A\u8C03\u5EA6\u5468\u671F"}),children:[(0,e.jsx)(Ae,{name:"time",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.timeLabel",defaultMessage:"\u5F00\u59CB\u65F6\u95F4"}),rules:[{required:!0,message:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.updateForm.schedulingPeriod.timeRules",defaultMessage:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4\uFF01"})}]}),(0,e.jsx)(re.Z,{name:"frequency",label:s.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"\u76D1\u63A7\u5BF9\u8C61"}),width:"md",valueEnum:{month:"\u6708",week:"\u5468"}})]})]})},We=Ie,Ue=["defaultRender"],$e=function(){var t=f()(o().mark(function l(s){var r;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=S.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),n.prev=1,n.next=4,z(h()({},s));case 4:return r(),S.ZP.success("Added successfully"),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(1),r(),S.ZP.error("Adding failed, please try again!"),n.abrupt("return",!1);case 14:case"end":return n.stop()}},l,null,[[1,9]])}));return function(s){return t.apply(this,arguments)}}(),Ke=function(){var t=f()(o().mark(function l(s){var r;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=S.ZP.loading("Configuring"),n.prev=1,n.next=4,V({name:s.name,desc:s.desc,key:s.key});case 4:return r(),S.ZP.success("Configuration is successful"),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(1),r(),S.ZP.error("Configuration failed, please try again!"),n.abrupt("return",!1);case 14:case"end":return n.stop()}},l,null,[[1,9]])}));return function(s){return t.apply(this,arguments)}}(),Ne=function(){var t=f()(o().mark(function l(s){var r;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=S.ZP.loading("\u6B63\u5728\u5220\u9664"),s){n.next=3;break}return n.abrupt("return",!0);case 3:return n.prev=3,n.next=6,Y({key:s.map(function($){return $.key})});case 6:return r(),S.ZP.success("Deleted successfully and will refresh soon"),n.abrupt("return",!0);case 11:return n.prev=11,n.t0=n.catch(3),r(),S.ZP.error("Delete failed, please try again"),n.abrupt("return",!1);case 16:case"end":return n.stop()}},l,null,[[3,11]])}));return function(s){return t.apply(this,arguments)}}(),Ge=function(){var l=(0,x.useState)(!1),s=v()(l,2),r=s[0],d=s[1],n=(0,x.useState)(!1),$=v()(n,2),te=$[0],H=$[1],ze=(0,x.useState)(!1),pe=v()(ze,2),ce=pe[0],me=pe[1],K=(0,x.useRef)(),Ye=(0,x.useState)(),fe=v()(Ye,2),T=fe[0],J=fe[1],He=(0,x.useState)([]),he=v()(He,2),N=he[0],ge=he[1],_=(0,u.useIntl)(),ve=[{title:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"Rule name"}),dataIndex:"name",tip:"The rule name is the unique key",render:function(p,c){return(0,e.jsx)("a",{onClick:function(){J(c),me(!0)},children:p})}},{title:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.titleDesc",defaultMessage:"Description"}),dataIndex:"desc",valueType:"textarea"},{title:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.titleCallNo",defaultMessage:"Number of service calls"}),dataIndex:"callNo",sorter:!0,hideInForm:!0,renderText:function(p){return"".concat(p).concat(_.formatMessage({id:"pages.searchTable.tenThousand",defaultMessage:" \u4E07 "}))}},{title:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.titleStatus",defaultMessage:"Status"}),dataIndex:"status",hideInForm:!0,valueEnum:{0:{text:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.nameStatus.default",defaultMessage:"Shut down"}),status:"Default"},1:{text:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.nameStatus.running",defaultMessage:"Running"}),status:"Processing"},2:{text:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.nameStatus.online",defaultMessage:"Online"}),status:"Success"},3:{text:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.nameStatus.abnormal",defaultMessage:"Abnormal"}),status:"Error"}}},{title:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.titleUpdatedAt",defaultMessage:"Last scheduled time"}),sorter:!0,dataIndex:"updatedAt",valueType:"dateTime",renderFormItem:function(p,c,y){var w=c.defaultRender,P=E()(c,Ue),Pe=y.getFieldValue("status");return"".concat(Pe)==="0"?!1:"".concat(Pe)==="3"?(0,e.jsx)(je.Z,h()(h()({},P),{},{placeholder:_.formatMessage({id:"pages.searchTable.exception",defaultMessage:"Please enter the reason for the exception!"})})):w(p)}},{title:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(p,c){return[(0,e.jsx)("a",{onClick:function(){H(!0),J(c)},children:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.config",defaultMessage:"Configuration"})},"config"),(0,e.jsx)("a",{href:"https://procomponents.ant.design/",children:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.subscribeAlert",defaultMessage:"Subscribe to alerts"})},"subscribeAlert")]}}];return(0,e.jsxs)(se._z,{children:[(0,e.jsx)(Me.Z,{headerTitle:_.formatMessage({id:"pages.searchTable.title",defaultMessage:"Enquiry form"}),actionRef:K,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){return[(0,e.jsxs)(ae.Z,{type:"primary",onClick:function(){d(!0)},children:[(0,e.jsx)(Fe.Z,{})," ",(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"New"})]},"primary")]},request:G,columns:ve,rowSelection:{onChange:function(p,c){ge(c)}}}),N?.length>0&&(0,e.jsxs)(se.Sc,{extra:(0,e.jsxs)("div",{children:[(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,e.jsx)("a",{style:{fontWeight:600},children:N.length})," ",(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"}),"\xA0\xA0",(0,e.jsxs)("span",{children:[(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.totalServiceCalls",defaultMessage:"Total number of service calls"})," ",N.reduce(function(m,p){return m+p.callNo},0)," ",(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.tenThousand",defaultMessage:"\u4E07"})]})]}),children:[(0,e.jsx)(ae.Z,{onClick:f()(o().mark(function m(){var p,c;return o().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,Ne(N);case 2:ge([]),(p=K.current)===null||p===void 0||(c=p.reloadAndRest)===null||c===void 0||c.call(p);case 4:case"end":return w.stop()}},m)})),children:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})}),(0,e.jsx)(ae.Z,{type:"primary",children:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.batchApproval",defaultMessage:"Batch approval"})})]}),(0,e.jsxs)(Te.Y,{title:_.formatMessage({id:"pages.searchTable.createForm.newRule",defaultMessage:"New rule"}),width:"400px",visible:r,onVisibleChange:d,onFinish:function(){var m=f()(o().mark(function p(c){var y;return o().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,$e(c);case 2:y=P.sent,y&&(d(!1),K.current&&K.current.reload());case 4:case"end":return P.stop()}},p)}));return function(p){return m.apply(this,arguments)}}(),children:[(0,e.jsx)(ne.Z,{rules:[{required:!0,message:(0,e.jsx)(u.FormattedMessage,{id:"pages.searchTable.ruleName",defaultMessage:"Rule name is required"})}],width:"md",name:"name"}),(0,e.jsx)(le.Z,{width:"md",name:"desc"})]}),(0,e.jsx)(We,{onSubmit:function(){var m=f()(o().mark(function p(c){var y;return o().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,Ke(c);case 2:y=P.sent,y&&(H(!1),J(void 0),K.current&&K.current.reload());case 4:case"end":return P.stop()}},p)}));return function(p){return m.apply(this,arguments)}}(),onCancel:function(){H(!1),ce||J(void 0)},updateModalVisible:te,values:T||{}}),(0,e.jsx)(xe.Z,{width:600,visible:ce,onClose:function(){J(void 0),me(!1)},closable:!1,children:T?.name&&(0,e.jsx)(be.vY,{column:2,title:T?.name,request:f()(o().mark(function m(){return o().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",{data:T||{}});case 1:case"end":return c.stop()}},m)})),params:{id:T?.name},columns:ve})})]})},Ve=Ge}}]);
