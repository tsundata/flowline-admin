"use strict";(self.webpackChunkflowline_admin=self.webpackChunkflowline_admin||[]).push([[382],{5966:function(ee,Z,e){var U=e(1413),M=e(44925),A=e(85893),b=e(2123),G=["fieldProps","proFieldProps"],h=["fieldProps","proFieldProps"],D="text",n=function(j){var F=j.fieldProps,L=j.proFieldProps,O=(0,M.Z)(j,G);return(0,A.jsx)(b.Z,(0,U.Z)({valueType:D,fieldProps:F,filedConfig:{valueType:D},proFieldProps:L},O))},_=function(j){var F=j.fieldProps,L=j.proFieldProps,O=(0,M.Z)(j,h);return(0,A.jsx)(b.Z,(0,U.Z)({valueType:"password",fieldProps:F,proFieldProps:L,filedConfig:{valueType:D}},O))},S=n;S.Password=_,S.displayName="ProFormComponent",Z.Z=S},21004:function(ee,Z,e){e.r(Z),e.d(Z,{default:function(){return l}});var U=e(80164),M=e.n(U),A=e(74411),b=e.n(A),G=e(55559),h=e.n(G),D=e(45223),n=e.n(D),_=e(65262),S=e(49101),W=e(48705),j=e(51851),F=e(20761),L=e(5966),O=e(60415),p=e(95952),w=e(48086),R=e(71577),z=e(25084),E=e(67294),J=e(63436),k=e(50146),Q=e(86835),I=e(34041),s=e(85893),K=function(r){var t=(0,p.useIntl)(),d=[{label:"GET",value:"GET"},{label:"LIST",value:"LIST"},{label:"WATCH",value:"WATCH"},{label:"POST",value:"POST"},{label:"PATCH",value:"PATCH"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"}],u=[{label:"code",value:"code"},{label:"connection",value:"connection"},{label:"dag",value:"dag"},{label:"job",value:"job"},{label:"role",value:"role"},{label:"user",value:"user"},{label:"variable",value:"variable"},{label:"workflow",value:"workflow"},{label:"event",value:"event"},{label:"stage",value:"stage"},{label:"worker",value:"worker"}];return(0,s.jsx)(k.Z,{width:800,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:t.formatMessage({id:"pages.roleList.form.roleConfig",defaultMessage:"\u7528\u6237\u7F16\u8F91"}),visible:r.updateModalVisible,onCancel:function(){r.onCancel()},footer:null,children:(0,s.jsxs)(J.A,{initialValues:{name:r.values.name,verbs:r.values.verbs,resources:r.values.resources},title:t.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),onFinish:function(){var a=h()(n().mark(function x(f){return n().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,r.onSubmit(b()(b()({},r.values),f));case 2:return T.abrupt("return",!0);case 3:case"end":return T.stop()}},x)}));return function(x){return a.apply(this,arguments)}}(),submitter:{submitButtonProps:{},render:function(x){return[(0,s.jsx)(R.Z,{type:"primary",onClick:function(){var P,T;return(P=x.form)===null||P===void 0||(T=P.submit)===null||T===void 0?void 0:T.call(P)},children:"\u63D0\u4EA4"},"submit"),(0,s.jsx)(R.Z,{type:"dashed",onClick:function(){var P;return(P=x.form)===null||P===void 0?void 0:P.resetFields()},children:"\u91CD\u7F6E"},"rest"),(0,s.jsx)(R.Z,{type:"dashed",onClick:function(){return r.onCancel()},children:"\u53D6\u6D88"},"cancel")]}},children:[(0,s.jsx)(L.Z,{rules:[{required:!0,message:(0,s.jsx)(p.FormattedMessage,{id:"pages.roleList.ruleName",defaultMessage:"Role name is required"})}],name:"name",placeholder:t.formatMessage({id:"pages.roleList.form.name",defaultMessage:"Role name"}),label:t.formatMessage({id:"pages.roleList.form.name",defaultMessage:"Role name"})}),(0,s.jsx)(Q.Z.Item,{name:"verbs",label:t.formatMessage({id:"pages.userList.form.verbs",defaultMessage:"verbs"}),children:(0,s.jsx)(I.Z,{mode:"multiple",options:d,placeholder:t.formatMessage({id:"pages.roleList.form.verbs.placeholder",defaultMessage:"verbs"})})}),(0,s.jsx)(Q.Z.Item,{name:"resources",label:t.formatMessage({id:"pages.roleList.form.resources",defaultMessage:"resources"}),children:(0,s.jsx)(I.Z,{mode:"multiple",options:u,placeholder:t.formatMessage({id:"pages.roleList.form.resources.placeholder",defaultMessage:"resources"})})})]})})},X=K,V=function(){var c=h()(n().mark(function r(t){var d,u,a;return n().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return d=w.ZP.loading("Adding"),f.prev=1,u="role",a="v1",f.next=6,(0,_.v9)(b()(b()({},t),{},{kind:u,apiVersion:a}));case 6:return d(),w.ZP.success("Added successfully"),f.abrupt("return",!0);case 11:return f.prev=11,f.t0=f.catch(1),d(),w.ZP.error("Adding failed, please try again!"),f.abrupt("return",!1);case 16:case"end":return f.stop()}},r,null,[[1,11]])}));return function(t){return c.apply(this,arguments)}}(),re=function(){var c=h()(n().mark(function r(t){var d;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=w.ZP.loading("Updating"),a.prev=1,a.next=4,(0,_.vh)({uid:t.uid},t);case 4:return d(),w.ZP.success("Update is successful"),a.abrupt("return",!0);case 9:return a.prev=9,a.t0=a.catch(1),d(),w.ZP.error("Update failed, please try again!"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},r,null,[[1,9]])}));return function(t){return c.apply(this,arguments)}}(),N=function(){var c=h()(n().mark(function r(t){var d;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=w.ZP.loading("deleting"),t){a.next=3;break}return a.abrupt("return",!0);case 3:return a.prev=3,a.next=6,(0,_.Fe)({uid:"-"});case 6:return d(),w.ZP.success("Deleted successfully and will refresh soon"),a.abrupt("return",!0);case 11:return a.prev=11,a.t0=a.catch(3),d(),w.ZP.error("Delete failed, please try again"),a.abrupt("return",!1);case 16:case"end":return a.stop()}},r,null,[[3,11]])}));return function(t){return c.apply(this,arguments)}}(),o=function(){var r=(0,E.useState)(!1),t=M()(r,2),d=t[0],u=t[1],a=(0,E.useState)(!1),x=M()(a,2),f=x[0],P=x[1],T=(0,E.useState)(!1),ae=M()(T,2),te=ae[0],se=ae[1],$=(0,E.useRef)(),ie=(0,E.useState)(),ne=M()(ie,2),y=ne[0],H=ne[1],de=(0,E.useState)([]),le=M()(de,2),Y=le[0],ue=le[1],q=(0,p.useIntl)(),oe=[{title:(0,s.jsx)(p.FormattedMessage,{id:"pages.common.uid",defaultMessage:"UID"}),dataIndex:"uid",tip:"The uid is the unique key",render:function(i,m){return(0,s.jsx)("a",{onClick:function(){H(m),se(!0)},children:i})}},{title:(0,s.jsx)(p.FormattedMessage,{id:"pages.roleList.form.roleName.nameLabel",defaultMessage:"Role name"}),dataIndex:"name"},{title:(0,s.jsx)(p.FormattedMessage,{id:"pages.roleList.form.verbs",defaultMessage:"verbs"}),dataIndex:"verbs",renderText:function(i){return i&&i.join(", ")}},{title:(0,s.jsx)(p.FormattedMessage,{id:"pages.roleList.form.resources",defaultMessage:"resources"}),dataIndex:"resources",renderText:function(i){return i&&i.join(", ")}},{title:(0,s.jsx)(p.FormattedMessage,{id:"pages.roleList.titleCreatedAt",defaultMessage:"Created time"}),sorter:!0,dataIndex:"creationTimestamp",valueType:"dateTime"},{title:(0,s.jsx)(p.FormattedMessage,{id:"pages.common.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(i,m){return[(0,s.jsx)("a",{onClick:function(){P(!0),H(m)},children:(0,s.jsx)(p.FormattedMessage,{id:"pages.roleList.form.roleConfig",defaultMessage:"Configuration"})},"config")]}}];return(0,s.jsxs)(W._z,{children:[(0,s.jsx)(j.Z,{headerTitle:q.formatMessage({id:"pages.common.tableTitle",defaultMessage:"Enquiry form"}),actionRef:$,rowKey:"uid",search:{labelWidth:120},toolBarRender:function(){return[(0,s.jsxs)(R.Z,{type:"primary",onClick:function(){u(!0)},children:[(0,s.jsx)(S.Z,{})," ",(0,s.jsx)(p.FormattedMessage,{id:"pages.common.new",defaultMessage:"New"})]},"primary")]},request:h()(n().mark(function v(){var i;return n().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,_.Uy)();case 2:return i=g.sent,g.abrupt("return",{data:i.items,success:!0});case 4:case"end":return g.stop()}},v)})),columns:oe,rowSelection:{onChange:function(i,m){ue(m)}}}),Y?.length>0&&(0,s.jsx)(W.Sc,{extra:(0,s.jsxs)("div",{children:[(0,s.jsx)(p.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,s.jsx)("a",{style:{fontWeight:600},children:Y.length})," ",(0,s.jsx)(p.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"})]}),children:(0,s.jsx)(R.Z,{onClick:h()(n().mark(function v(){var i,m;return n().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,N(Y);case 2:ue([]),(i=$.current)===null||i===void 0||(m=i.reloadAndRest)===null||m===void 0||m.call(i);case 4:case"end":return B.stop()}},v)})),children:(0,s.jsx)(p.FormattedMessage,{id:"pages.common.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,s.jsx)(F.Y,{title:q.formatMessage({id:"pages.roleList.form.newRole",defaultMessage:"New role"}),width:"400px",visible:d,onVisibleChange:u,onFinish:function(){var v=h()(n().mark(function i(m){var g;return n().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,V(m);case 2:g=C.sent,g&&(u(!1),$.current&&$.current.reload());case 4:case"end":return C.stop()}},i)}));return function(i){return v.apply(this,arguments)}}(),children:(0,s.jsx)(L.Z,{rules:[{required:!0,message:(0,s.jsx)(p.FormattedMessage,{id:"pages.roleList.ruleName",defaultMessage:"Role name is required"})}],width:"md",name:"name",placeholder:q.formatMessage({id:"pages.roleList.form.name",defaultMessage:"Role name"})})}),(0,s.jsx)(X,{onSubmit:function(){var v=h()(n().mark(function i(m){var g;return n().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,re(m);case 2:g=C.sent,g&&(P(!1),H(void 0),$.current&&$.current.reload());case 4:case"end":return C.stop()}},i)}));return function(i){return v.apply(this,arguments)}}(),onCancel:function(){P(!1),te||H(void 0)},updateModalVisible:f,values:y||{}}),(0,s.jsx)(z.Z,{width:600,visible:te,onClose:function(){H(void 0),se(!1)},closable:!1,children:y?.uid&&(0,s.jsx)(O.vY,{column:2,title:y?.uid,request:h()(n().mark(function v(){return n().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",{data:y||{}});case 1:case"end":return m.stop()}},v)})),params:{id:y?.uid},columns:oe})})]})},l=o},65262:function(ee,Z,e){e.d(Z,{Fe:function(){return J},Uy:function(){return X},v9:function(){return O},vh:function(){return z}});var U=e(56307),M=e.n(U),A=e(74411),b=e.n(A),G=e(55559),h=e.n(G),D=e(45223),n=e.n(D),_=e(95952),S=null,W=["uid"],j=["uid"],F=null,L=null;function O(o,l){return p.apply(this,arguments)}function p(){return p=h()(n().mark(function o(l,c){return n().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,_.request)("/api/apps/v1/role",b()({method:"POST",headers:{"Content-Type":"application/json"},data:l},c||{})));case 1:case"end":return t.stop()}},o)})),p.apply(this,arguments)}function w(o,l){return R.apply(this,arguments)}function R(){return R=_asyncToGenerator(_regeneratorRuntime.mark(function o(l,c){var r,t;return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r=l.uid,t=_objectWithoutProperties(l,S),u.abrupt("return",request("/api/apps/v1/role/".concat(r),_objectSpread({method:"GET",params:_objectSpread({},t)},c||{})));case 2:case"end":return u.stop()}},o)})),R.apply(this,arguments)}function z(o,l,c){return E.apply(this,arguments)}function E(){return E=h()(n().mark(function o(l,c,r){var t,d;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=l.uid,d=M()(l,W),a.abrupt("return",(0,_.request)("/api/apps/v1/role/".concat(t),b()({method:"PUT",headers:{"Content-Type":"application/json"},params:b()({},d),data:c},r||{})));case 2:case"end":return a.stop()}},o)})),E.apply(this,arguments)}function J(o,l){return k.apply(this,arguments)}function k(){return k=h()(n().mark(function o(l,c){var r,t;return n().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r=l.uid,t=M()(l,j),u.abrupt("return",(0,_.request)("/api/apps/v1/role/".concat(r),b()({method:"DELETE",params:b()({},t)},c||{})));case 2:case"end":return u.stop()}},o)})),k.apply(this,arguments)}function Q(o,l,c){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime.mark(function o(l,c,r){var t,d;return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=l.uid,d=_objectWithoutProperties(l,F),a.abrupt("return",request("/api/apps/v1/role/".concat(t),_objectSpread({method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},params:_objectSpread({},d),data:c},r||{})));case 2:case"end":return a.stop()}},o)})),I.apply(this,arguments)}function s(o,l){return K.apply(this,arguments)}function K(){return K=_asyncToGenerator(_regeneratorRuntime.mark(function o(l,c){var r,t;return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r=l.uid,t=_objectWithoutProperties(l,L),u.abrupt("return",request("/api/apps/v1/role/".concat(r,"/watch"),_objectSpread({method:"GET",params:_objectSpread({},t)},c||{})));case 2:case"end":return u.stop()}},o)})),K.apply(this,arguments)}function X(o){return V.apply(this,arguments)}function V(){return V=h()(n().mark(function o(l){return n().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,_.request)("/api/apps/v1/role/list",b()({method:"GET"},l||{})));case 1:case"end":return r.stop()}},o)})),V.apply(this,arguments)}function re(o){return N.apply(this,arguments)}function N(){return N=_asyncToGenerator(_regeneratorRuntime.mark(function o(l){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/apps/v1/role/watch",_objectSpread({method:"GET"},l||{})));case 1:case"end":return r.stop()}},o)})),N.apply(this,arguments)}}}]);
