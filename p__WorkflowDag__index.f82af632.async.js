"use strict";(self.webpackChunkflowline_admin=self.webpackChunkflowline_admin||[]).push([[375],{61051:function(Ve,K,C){C.r(K),C.d(K,{WorkflowDag:function(){return q},default:function(){return Le}});var _=C(55559),m=C.n(_),ee=C(45223),e=C.n(ee),F=C(67294),r=C(59070),re=C(25680),ne=C.n(re),ae=C(74411),N=C.n(ae),M=C(92757),te=C(62914),ie=C(79910),H=C(51446);function W(p){return N()({id:(0,r.k$)(),type:r.Ak.AnchorType.INPUT,group:r.Ak.AnchorGroup.TOP,tooltip:"\u8F93\u5165\u6869"},p)}var ue=(0,r.vD)(function(p){p.setRegisterHook(function(h){var S=[h.reactNodeRender.registerHook({name:"add react node",handler:function(){var t=m()(e().mark(function n(a){return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a.set(M.or,te.E),a.set(M.pN,ie.G);case 2:case"end":return i.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()}),h.graphOptions.registerHook({name:"custom-x6-options",after:"dag-extension-x6-options",handler:function(){var t=m()(e().mark(function n(a){var o;return e().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:a.grid=!1,a.keyboard={enabled:!0},o={connecting:{validateConnection:function(v){var l=v.sourceView,k=v.targetView,y=v.sourceMagnet,D=v.targetMagnet;if(l===k||y?.getAttribute("port-group")===r.Ak.AnchorGroup.TOP||D?.getAttribute("port-group")!==r.Ak.AnchorGroup.TOP||!y||!D)return!1;var s=k.cell,f=D.getAttribute("port"),E=s.getPort(f);return!!E}}},a.connecting=N()(N()({},a.connecting),o.connecting);case 4:case"end":return u.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()}),h.x6Events.registerHook({name:"add",handler:function(){var t=m()(e().mark(function n(a){return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a.push({eventName:"node:moved",callback:function(d,v){var l=d.node;v.executeCommand(r.cE.MOVE_NODE.id,{id:l.id,position:l.getPosition()})}},{eventName:"edge:added",callback:function(d,v){var l=d.edge.getTargetNode(),k=H.QK.getByPath(d,"options.isCommand","."),y=H.QK.getByPath(d,"options.isRenderGraph",".");!k||y||l&&v.executeCommand(r.cE.UPDATE_NODE_PORT.id,{node:l,updatePorts:function(){var D=m()(e().mark(function f(E){return e().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",[].concat(ne()(E),[W({})]));case 1:case"end":return w.stop()}},f)}));function s(f){return D.apply(this,arguments)}return s}()})}},{eventName:"edge:removed",callback:function(d,v){var l=d.edge.getTargetCellId(),k=d.edge.getTargetPortId(),y=H.QK.getByPath(d,"options.isCommand","."),D=H.QK.getByPath(d,"options.isRenderGraph",".");!y||D||v.executeCommand(r.cE.UPDATE_NODE_PORT.id,{node:l,updatePorts:function(){var s=m()(e().mark(function E(b){var w,O;return e().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return w=b.filter(function($){return $.id!==k}),O=w.filter(function($){return $.type===r.Ak.AnchorType.INPUT}),O.length===0&&w.push(W({})),P.abrupt("return",w);case 4:case"end":return P.stop()}},E)}));function f(E){return s.apply(this,arguments)}return f}()})}});case 1:case"end":return i.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()})],g=new r.K4;return g.pushAll(S),g})}),oe=C(91994),le=C(80164),se=C.n(le),Q=C(8609),A;(function(p){var h=p.NODE_COMMON_PROPS={renderKey:M.or,width:M.nK,height:M.M8},S=p.queryGraphMeta=function(){var s=m()(e().mark(function f(E){return e().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",N()(N()({},E),{},{flowId:E.meta.flowId}));case 1:case"end":return w.stop()}},f)}));return function(f){return s.apply(this,arguments)}}(),g=p.loadGraphData=function(){var s=m()(e().mark(function f(E){return e().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,Q.xI)({uid:E.flowId});case 2:return w.abrupt("return",w.sent);case 3:case"end":return w.stop()}},f)}));return function(f){return s.apply(this,arguments)}}(),t=p.saveGraphData=function(){var s=m()(e().mark(function f(E,b){var w;return e().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return console.log(E,b),b.nodes.map(function(P,$){var L,U={};b.nodes[$].ports=(L=P.ports)===null||L===void 0?void 0:L.filter(function(Y){return U[Y.id]?!1:(U[Y.id]=!0,!0)})}),G.next=4,(0,Q.W2)({uid:E.flowId},{nodes:b.nodes,edges:b.edges,kind:"dag",apiVersion:"v1"});case 4:return w=G.sent,G.abrupt("return",{success:w.status,data:b});case 6:case"end":return G.stop()}},f)}));return function(f,E){return s.apply(this,arguments)}}(),c=p.checkGraphData=function(){var s=m()(e().mark(function f(E,b){return e().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return console.log(E,b),O.abrupt("return",{success:!1,data:b});case 2:case"end":return O.stop()}},f)}));return function(f,E){return s.apply(this,arguments)}}(),n=p.deployDagService=function(){var s=m()(e().mark(function f(E,b){return e().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.abrupt("return",{success:!0,data:b});case 1:case"end":return O.stop()}},f)}));return function(f,E){return s.apply(this,arguments)}}(),a=p.addNode=function(){var s=m()(e().mark(function f(E){var b,w,O,G,P,$,L,U;return e().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return console.info("addNode service running, add node:",E),b=[{type:r.Ak.AnchorType.INPUT,group:r.Ak.AnchorGroup.TOP,tooltip:"\u8F93\u5165\u6869"},{type:r.Ak.AnchorType.OUTPUT,group:r.Ak.AnchorGroup.BOTTOM,tooltip:"\u8F93\u51FA\u6869"}],w=E.nodeConfig,O=w.id,G=w.ports,P=G===void 0?b:G,$=w.groupChildren,L=O||(0,r.k$)(),U=N()(N()(N()({},h),E.nodeConfig),{},{id:L,ports:P.map(function(Ue){return N()(N()({},Ue),{},{id:(0,r.k$)()})})}),$&&$.length&&(U.ports=[]),x.abrupt("return",U);case 7:case"end":return x.stop()}},f)}));return function(f){return s.apply(this,arguments)}}(),o=p.renameNode=function(){var s=m()(e().mark(function f(E,b,w){return e().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.abrupt("return",{err:null,nodeName:E});case 1:case"end":return G.stop()}},f)}));return function(f,E,b){return s.apply(this,arguments)}}(),i=p.delNode=function(){var s=m()(e().mark(function f(E){return e().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return console.info("delNode service running, del node:",E.nodeConfig.id),w.abrupt("return",!0);case 2:case"end":return w.stop()}},f)}));return function(f){return s.apply(this,arguments)}}(),u=p.addEdge=function(){var s=m()(e().mark(function f(E){var b;return e().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return console.info("addEdge service running, add edge:",E),b=E.edgeConfig,O.abrupt("return",N()(N()({},b),{},{id:(0,r.k$)()}));case 3:case"end":return O.stop()}},f)}));return function(f){return s.apply(this,arguments)}}(),d=p.delEdge=function(){var s=m()(e().mark(function f(E){return e().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return console.info("delEdge service running, del edge:",E),w.abrupt("return",!0);case 2:case"end":return w.stop()}},f)}));return function(f){return s.apply(this,arguments)}}(),v=0,l={},k=r.yc.StatusEnum.DEFAULT,y=p.graphStatusService=m()(e().mark(function s(){return e().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v<4?(l["node".concat(v)]={status:r.yc.StatusEnum.SUCCESS},l["node".concat(v+1)]={status:r.yc.StatusEnum.PROCESSING},v+=1,k=r.yc.StatusEnum.PROCESSING):(v=0,l.node4={status:r.yc.StatusEnum.SUCCESS},k=r.yc.StatusEnum.SUCCESS),E.abrupt("return",{graphStatus:k,statusMap:l});case 2:case"end":return E.stop()}},s)})),D=p.stopGraphStatusService=m()(e().mark(function s(){return e().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return Object.entries(l).forEach(function(b){var w=se()(b,2),O=w[1],G=O,P=G.status;P===r.yc.StatusEnum.PROCESSING&&(O.status=r.yc.StatusEnum.ERROR)}),E.abrupt("return",{graphStatus:r.yc.StatusEnum.ERROR,statusMap:l});case 2:case"end":return E.stop()}},s)}))})(A||(A={}));var ce=(0,r.s4)(function(p){p.setCommandContributions(function(){return oe.m}),p.setRegisterHookFn(function(h){var S=[h.graphMeta.registerHook({name:"get graph meta from backend",handler:function(){var t=m()(e().mark(function n(a){return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a.graphMetaService=A.queryGraphMeta;case 1:case"end":return i.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()}),h.saveGraphData.registerHook({name:"save graph data",handler:function(){var t=m()(e().mark(function n(a){return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a.saveGraphDataService||(a.saveGraphDataService=A.saveGraphData);case 1:case"end":return i.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()}),h.addNode.registerHook({name:"get node config from backend api",handler:function(){var t=m()(e().mark(function n(a){return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a.createNodeService=A.addNode;case 1:case"end":return i.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()}),h.delNode.registerHook({name:"get edge config from backend api",handler:function(){var t=m()(e().mark(function n(a){return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a.deleteNodeService=A.delNode;case 1:case"end":return i.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()}),h.addEdge.registerHook({name:"get edge config from backend api",handler:function(){var t=m()(e().mark(function n(a){return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a.createEdgeService=A.addEdge,a.edgeConfig=N()(N()({},a.edgeConfig),{},{connector:{name:"rounded"},router:{name:"manhattan"}});case 2:case"end":return i.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()}),h.delEdge.registerHook({name:"get edge config from backend api",handler:function(){var t=m()(e().mark(function n(a){return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a.deleteEdgeService=A.delEdge;case 1:case"end":return i.stop()}},n)}));function c(n){return t.apply(this,arguments)}return c}()})],g=new r.K4;return g.pushAll(S),g})}),X=function(h){h.executeCommandPipeline([{commandId:r.Gv.LOAD_DATA.id,getCommandOption:function(){var S=m()(e().mark(function t(){return e().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",{args:{loadDataService:A.loadGraphData}});case 1:case"end":return n.stop()}},t)}));function g(){return S.apply(this,arguments)}return g}()},{commandId:r.Gv.GRAPH_LAYOUT.id,getCommandOption:function(){var S=m()(e().mark(function t(c){var n,a;return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=c.getResult(),a=n.graphData,i.abrupt("return",{args:{layoutType:"dagre",layoutOptions:{type:"dagre",rankdir:"TB",nodesep:60,ranksep:30},graphData:a}});case 2:case"end":return i.stop()}},t)}));function g(t){return S.apply(this,arguments)}return g}()},{commandId:r.Gv.GRAPH_RENDER.id,getCommandOption:function(){var S=m()(e().mark(function t(c){var n,a;return e().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=c.getResult(),a=n.graphData,i.abrupt("return",{args:{graphData:a}});case 2:case"end":return i.stop()}},t)}));function g(t){return S.apply(this,arguments)}return g}()},{commandId:r.Gv.GRAPH_ZOOM.id,getCommandOption:function(){var S=m()(e().mark(function t(){return e().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",{args:{factor:"fit",zoomOptions:{maxScale:.9}}});case 1:case"end":return n.stop()}},t)}));function g(){return S.apply(this,arguments)}return g}()}])},j;(function(p){var h=p.id="test"})(j||(j={}));var de=(0,r.HJ)(function(p){p.registerModel(function(h){return h.registerModel({id:j.id,getInitialValue:function(){e:;}})})}),He=null,B=C(90387),pe=C(73171),fe=C(8212),z=C(15360),ve=C(50146),R;(function(p){r.ko.set("DeleteOutlined",pe.Z),r.ko.set("EditOutlined",fe.Z),r.ko.set("StopOutlined",z.Z);var h=p.DELETE_EDGE={id:r.$b.DEL_EDGE.id,label:"Delete edge",iconName:"DeleteOutlined",onClick:function(){var n=m()(e().mark(function o(i){var u,d;return e().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:u=i.target,d=i.commandService,d.executeCommand(r.$b.DEL_EDGE.id,{edgeConfig:u.data});case 2:case"end":return l.stop()}},o)}));function a(o){return n.apply(this,arguments)}return a}()},S=p.DELETE_NODE={id:r.cE.DEL_NODE.id,label:"Delete node",iconName:"DeleteOutlined",onClick:function(){var n=m()(e().mark(function o(i){var u,d,v,l;return e().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:v=i.target,l=i.commandService,ve.Z.confirm({title:"Confirm delete node?",content:"".concat((u=v.data)===null||u===void 0?void 0:u.label," [").concat((d=v.data)===null||d===void 0?void 0:d.id,"]"),okText:"Confirm",cancelText:"Cancel",onOk:function(){l.executeCommand(r.cE.DEL_NODE.id,{nodeConfig:{id:v.data.id}})}});case 2:case"end":return y.stop()}},o)}));function a(o){return n.apply(this,arguments)}return a}()},g=p.EMPTY_MENU={id:"EMPTY_MENU_ITEM",label:"Not available yet",isEnabled:!1,iconName:"DeleteOutlined"},t=p.RENAME_NODE={id:B.E.SHOW_RENAME_MODAL.id,label:"Rename",isVisible:!0,iconName:"EditOutlined",onClick:function(){var n=m()(e().mark(function o(i){var u,d,v;return e().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:u=i.target,d=i.commandService,v=u.data,d.executeCommand(B.E.SHOW_RENAME_MODAL.id,{nodeConfig:v,updateNodeNameService:A.renameNode});case 3:case"end":return k.stop()}},o)}));function a(o){return n.apply(this,arguments)}return a}()},c=p.SEPARATOR={id:"separator",type:r.UI.Separator}})(R||(R={}));var me=(0,r.Kd)(function(p){p.setMenuModelService(function(){var h=m()(e().mark(function S(g,t,c,n){var a,o;return e().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:a=g.type,o=g.cell,u.t0=a,u.next=u.t0==="node"?4:u.t0==="edge"?6:u.t0==="blank"?8:10;break;case 4:return t.setValue({id:"root",type:r.UI.Root,submenu:[R.DELETE_NODE,R.RENAME_NODE]}),u.abrupt("break",12);case 6:return t.setValue({id:"root",type:r.UI.Root,submenu:[R.DELETE_EDGE]}),u.abrupt("break",12);case 8:return t.setValue({id:"root",type:r.UI.Root,submenu:[R.EMPTY_MENU]}),u.abrupt("break",12);case 10:return t.setValue({id:"root",type:r.UI.Root,submenu:[R.EMPTY_MENU]}),u.abrupt("break",12);case 12:case"end":return u.stop()}},S)}));return function(S,g,t,c){return h.apply(this,arguments)}}())}),he=C(92104),ge=C(97254),Ee=C(18094),Se=C(36371),we=C(50827),Ce=C(54034),J=C(24565),T=C(85893),V;(function(p){r.ko.set("SaveOutlined",he.Z),r.ko.set("CloudSyncOutlined",ge.Z),r.ko.set("GatewayOutlined",Ee.Z),r.ko.set("GroupOutlined",Se.Z),r.ko.set("UngroupOutlined",we.Z),r.ko.set("PlaySquareOutlined",Ce.Z),r.ko.set("StopOutlined",z.Z);var h=p.getDependencies=function(){var t=m()(e().mark(function c(n){return e().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.dX.SELECTED_CELLS.getModel(n);case 2:return o.t0=o.sent,o.next=5,r.dX.GRAPH_ENABLE_MULTI_SELECT.getModel(n);case 5:return o.t1=o.sent,o.next=8,r.yc.MODEL.getModel(n);case 8:return o.t2=o.sent,o.abrupt("return",[o.t0,o.t1,o.t2]);case 10:case"end":return o.stop()}},c)}));return function(c){return t.apply(this,arguments)}}(),S=p.getToolbarState=function(){var t=m()(e().mark(function c(n){var a,o,i,u,d;return e().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.dX.GRAPH_ENABLE_MULTI_SELECT.useValue(n);case 2:return a=l.sent,o=a.isEnable,l.next=6,r.dX.IS_GROUP_SELECTED.useValue(n);case 6:return i=l.sent,l.next=9,r.dX.IS_NORMAL_NODES_SELECTED.useValue(n);case 9:return u=l.sent,l.next=12,r.yc.MODEL.useValue(n);case 12:return d=l.sent,l.abrupt("return",{isNodeSelected:u,isGroupSelected:i,isMultiSelectionActive:o,isProcessing:d.graphStatus===r.yc.StatusEnum.PROCESSING});case 14:case"end":return l.stop()}},c)}));return function(c){return t.apply(this,arguments)}}(),g=p.getToolbarItems=function(){var t=m()(e().mark(function c(n){var a,o;return e().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return a=[],o=[],a.push({id:r.Gv.SAVE_GRAPH_DATA.id+"check",iconName:"GatewayOutlined",tooltip:"Grammar check",onClick:function(){var d=m()(e().mark(function l(k){var y;return e().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:y=k.commandService,y.executeCommand(r.Gv.SAVE_GRAPH_DATA.id,{saveGraphDataService:function(E,b){return A.checkGraphData(E,b)}});case 2:case"end":return s.stop()}},l)}));function v(l){return d.apply(this,arguments)}return v}()}),a.push({id:r.Gv.SAVE_GRAPH_DATA.id,iconName:"SaveOutlined",tooltip:"Save data",onClick:function(){var d=m()(e().mark(function l(k){var y;return e().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:y=k.commandService,y.executeCommand(r.Gv.SAVE_GRAPH_DATA.id,{saveGraphDataService:function(E,b){return A.saveGraphData(E,b)}});case 2:case"end":return s.stop()}},l)}));function v(l){return d.apply(this,arguments)}return v}(),render:function(v){return(0,T.jsx)(J.Z,{title:"Confirm to save data\uFF1F",onConfirm:function(){v.onClick()},children:v.children})}}),o.push({id:r.ho.QUERY_GRAPH_STATUS.id+"play",tooltip:"Start execution",iconName:"PlaySquareOutlined",isEnabled:!n.isProcessing,onClick:function(){var d=m()(e().mark(function l(k){var y;return e().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:y=k.commandService,y.executeCommand(r.ho.QUERY_GRAPH_STATUS.id,{graphStatusService:A.graphStatusService,loopInterval:3e3});case 2:case"end":return s.stop()}},l)}));function v(l){return d.apply(this,arguments)}return v}()}),o.push({id:r.ho.QUERY_GRAPH_STATUS.id+"stop",tooltip:"Stop execution",iconName:"StopOutlined",isEnabled:n.isProcessing,onClick:function(){var d=m()(e().mark(function l(k){var y;return e().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:y=k.commandService,y.executeCommand(r.ho.QUERY_GRAPH_STATUS.id,{graphStatusService:A.stopGraphStatusService,loopInterval:5e3});case 2:case"end":return s.stop()}},l)}));function v(l){return d.apply(this,arguments)}return v}(),render:function(v){return(0,T.jsx)(J.Z,{title:"Confirm stop execution\uFF1F",onConfirm:function(){v.onClick()},children:v.children})}}),u.abrupt("return",[{name:"graphData",items:a},{name:"customCmd",items:o}]);case 7:case"end":return u.stop()}},c)}));return function(c){return t.apply(this,arguments)}}()})(V||(V={}));var ke=(0,r.iR)(function(p){p.setToolbarModelService(function(){var h=m()(e().mark(function S(g,t,c){var n,a,o;return e().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n=function(){var d=m()(e().mark(function v(){var l,k;return e().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,V.getToolbarState(t);case 2:return l=D.sent,D.next=5,V.getToolbarItems(l);case 5:k=D.sent,g.setValue(function(s){s.mainGroups=k});case 7:case"end":return D.stop()}},v)}));return function(){return d.apply(this,arguments)}}(),u.next=3,V.getDependencies(t);case 3:a=u.sent,o=a.map(function(d){return d.watch(m()(e().mark(function v(){return e().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:n();case 1:case"end":return k.stop()}},v)})))}),c.pushAll(o);case 6:case"end":return u.stop()}},S)}));return function(S,g,t){return h.apply(this,arguments)}}())}),ye=(0,r.zg)(function(p){p.setKeybindingFunc(function(h){return h.registerKeybinding([{id:"delete node or edge",keybinding:"backspace",callback:function(){var S=m()(e().mark(function t(c,n,a){var o;return e().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.dX.SELECTED_CELLS.useValue(n);case 2:return o=u.sent,u.next=5,Promise.all(o.map(function(d){if(d.isEdge())return a.executeCommand(r.$b.DEL_EDGE.id,{edgeConfig:N()(N()({},d.getData()),{},{id:d.id})})}));case 5:return u.next=7,Promise.all(o.map(function(d){if(d.isNode())return a.executeCommand(r.cE.DEL_NODE.id,{nodeConfig:N()(N()({},d.getData()),{},{id:d.id})})}));case 7:case"end":return u.stop()}},t)}));function g(t,c,n){return S.apply(this,arguments)}return g}()},{id:"copy",keybinding:["command+c","ctrl+c"],callback:function(){var S=m()(e().mark(function t(c,n,a,o){return e().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o.preventDefault(),a.executeCommand(r.Gv.GRAPH_COPY.id,{});case 2:case"end":return u.stop()}},t)}));function g(t,c,n,a){return S.apply(this,arguments)}return g}()},{id:"paste",keybinding:["command+v","ctrl+v"],callback:function(){var S=m()(e().mark(function t(c,n,a,o){return e().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o.preventDefault(),a.executeCommand(r.Gv.GRAPH_PASTE.id,{});case 2:case"end":return u.stop()}},t)}));function g(t,c,n,a){return S.apply(this,arguments)}return g}()}])})}),be=C(91894),De=function(){var p=m()(e().mark(function h(S,g,t){var c;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:c={nodeConfig:N()(N()({},S),{},{id:(0,r.k$)()})},g.executeCommand(r.cE.ADD_NODE.id,c);case 2:case"end":return a.stop()}},h)}));return function(S,g,t){return p.apply(this,arguments)}}(),Oe=function(h){return(0,T.jsxs)(be.Z,{size:"small",title:"Introduction to Compute Nodes",style:{width:"200px"},bordered:!1,children:["Welcome\uFF1A",h.name,"Here you can perform operations according to the set code"]})},Ne=function(){var p=m()(e().mark(function h(S,g){return e().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",[{id:"data calculation",header:"Data calculation",children:[{id:"2",label:"Compute Node",parentId:"1",renderKey:M.or,popoverContent:(0,T.jsx)(Oe,{name:"Compute Node"})}]}]);case 1:case"end":return c.stop()}},h)}));return function(S,g){return p.apply(this,arguments)}}(),Ge=function(){var p=m()(e().mark(function h(){var S,g,t=arguments;return e().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return S=t.length>0&&t[0]!==void 0?t[0]:[],g=t.length>1?t[1]:void 0,n.abrupt("return",S.filter(function(a){return a.label.includes(g)}));case 3:case"end":return n.stop()}},h)}));return function(){return p.apply(this,arguments)}}(),I=C(72116),Te=C(76888),Ae=C(68564),Pe=C(26904);function xe(p){return new Promise(function(h){return setTimeout(function(){return h(!0)},p)})}var $e=function(){var p=m()(e().mark(function h(S){var g,t,c,n,a,o,i,u,d,v,l,k,y;return e().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=S.modelService,a=S.targetType,s.next=3,r.dX.GRAPH_META.useValue(n);case 3:if(o=s.sent,a!=="canvas"){s.next=6;break}return s.abrupt("return",{tabs:[{name:"DagMeta",groups:[{name:"groupName",controls:[{name:"workflowUID",label:"Workflow UID",shape:"Input",disabled:!0,required:!0,tooltip:"Workflow UID",extra:"",placeholder:"workflow uid",value:"",defaultValue:o.flowId,hidden:!1,options:[{title:"",value:""}],originData:{}},{label:"Graph data",name:"graphJSON",shape:I.Y.EDITOR,disabled:!1,required:!0,tooltip:"JSON \u6570\u636E",placeholder:"JSON \u6570\u636E",value:"",defaultValue:"",hidden:!1,options:[{title:"",value:""}],originData:{}},{label:"View log link",name:"log",shape:I.Y.LINKSHAPE,disabled:!1,required:!0,tooltip:"log link",placeholder:"log link",value:"",defaultValue:"",hidden:!1,options:[{title:"",value:""}],originData:{}}]}]}]});case 6:return s.next=8,(0,Te.NQ)();case 8:return i=s.sent,s.next=11,(0,Pe.Xn)();case 11:return u=s.sent,s.next=14,(0,Ae.Pb)();case 14:return d=s.sent,v=[],i!=null&&i.items!=null&&i.items.forEach(function(f){v.push({label:f.name,value:f.uid})}),l=[],u!=null&&u.items!=null&&u.items.forEach(function(f){l.push({label:f.name,value:f.uid})}),k=[],d!=null&&d.items!=null&&d.items.forEach(function(f){k.push({label:f.name,value:f.uid})}),y={tabs:[{name:"NodeMeta",groups:[{name:"nodeName",controls:[{label:"Code",name:"code",shape:I.Y.SELECTOR,disabled:!1,required:!0,tooltip:"The code to be run by the compute node",placeholder:"please select code",value:(g=S.targetData)===null||g===void 0?void 0:g.code,defaultValue:"",hidden:!1,options:v,originData:{}},{label:"Variables",name:"variables",shape:I.Y.SELECTOR,disabled:!1,required:!1,tooltip:"Variables loaded by compute nodes",placeholder:"please select connections",value:(t=S.targetData)===null||t===void 0?void 0:t.variables,defaultValue:"",hidden:!1,options:l,originData:{}},{label:"Connections",name:"connections",shape:I.Y.SELECTOR,disabled:!1,required:!1,tooltip:"Connections loaded by compute nodes",placeholder:"please select connections",value:(c=S.targetData)===null||c===void 0?void 0:c.connections,defaultValue:"",hidden:!1,options:k,originData:{}}]}]}]},s.abrupt("return",y);case 23:case"end":return s.stop()}},h)}));return function(S){return p.apply(this,arguments)}}(),Re=function(){var p=m()(e().mark(function h(){return e().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:case"end":return g.stop()}},h)}));return function(){return p.apply(this,arguments)}}(),je=C(195),Z=C(95952),Me=C(48705),Ze=C(22970),Ie=C(71577),q=function(h){var S=h.meta,g=ue(h),t=ke(),c=me(),n=ce(),a=de(),o=ye(),i=(0,Z.useParams)(),u=(0,Z.useNavigate)(),d=F.useMemo(function(){return{app:null}},[]),v=function(){var k=m()(e().mark(function y(D){return e().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:d.app=D,X(d.app);case 2:case"end":return f.stop()}},y)}));return function(D){return k.apply(this,arguments)}}();F.useEffect(function(){d.app&&X(d.app)},[d,d.app,S]);var l=(0,Z.useIntl)();return(0,T.jsx)(Me._z,{header:{breadcrumb:{routes:[{path:"",breadcrumbName:l.formatMessage({id:"menu.workflows"})},{path:"",breadcrumbName:l.formatMessage({id:"menu.dag"})}]},extra:[(0,T.jsx)(Ie.Z,{onClick:function(){return u("/workflows")},children:l.formatMessage({id:"pages.common.back"})},"back")]},children:(0,T.jsxs)(r.g,{className:"dag-user-custom-clz",hookConfig:g,modelServiceConfig:a,commandConfig:n,onLoad:v,meta:{flowId:i.uid},children:[(0,T.jsx)(r.ce,{}),(0,T.jsx)(r.zl,{className:"xflow-node-panel",searchService:Ge,nodeDataService:Ne,onNodeDrop:De,position:{width:230,top:0,bottom:0,left:0},footerPosition:{height:0},bodyPosition:{top:40,bottom:0,left:0}}),(0,T.jsx)(r.xZ,{className:"xflow-workspace-toolbar-top",layout:"horizontal",config:t,position:{top:0,left:230,right:290,bottom:0}}),(0,T.jsxs)(r.n1,{position:{top:40,left:230,right:290,bottom:0},children:[(0,T.jsx)(r.It,{position:{top:12,right:12}}),(0,T.jsx)(r.g8,{config:c}),(0,T.jsx)(r.XS,{color:"#faad14"}),(0,T.jsx)(r.w5,{})]}),(0,T.jsx)(r.Ip,{controlMapService:I.O,formSchemaService:$e,formValueUpdateService:Re,bodyPosition:{top:0,bottom:0,right:0},position:{width:290,top:0,bottom:0,right:0},footerPosition:{height:0}}),(0,T.jsx)(r.G7,{config:o})]})})},Le=q}}]);
