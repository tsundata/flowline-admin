"use strict";(self.webpackChunkflowline_admin=self.webpackChunkflowline_admin||[]).push([[24],{64317:function(ve,X,t){var U=t(1413),B=t(44925),K=t(85893),T=t(22270),$=t(67294),I=t(66758),V=t(2123),h=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],H=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],r=$.forwardRef(function(E,ae){var re=E.fieldProps,ue=E.children,_=E.params,te=E.proFieldProps,de=E.mode,v=E.valueEnum,k=E.request,ee=E.showSearch,ce=E.options,W=(0,B.Z)(E,h),ne=(0,$.useContext)(I.Z);return(0,K.jsx)(V.Z,(0,U.Z)((0,U.Z)({valueEnum:(0,T.h)(v),request:k,params:_,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,U.Z)({options:ce,mode:de,showSearch:ee,getPopupContainer:ne.getPopupContainer},re),ref:ae,proFieldProps:te},W),{},{children:ue}))}),z=$.forwardRef(function(E,ae){var re=E.fieldProps,ue=E.children,_=E.params,te=E.proFieldProps,de=E.mode,v=E.valueEnum,k=E.request,ee=E.options,ce=(0,B.Z)(E,H),W=(0,U.Z)({options:ee,mode:de||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},re),ne=(0,$.useContext)(I.Z);return(0,K.jsx)(V.Z,(0,U.Z)((0,U.Z)({valueEnum:(0,T.h)(v),request:k,params:_,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,U.Z)({getPopupContainer:ne.getPopupContainer},W),ref:ae,proFieldProps:te},ce),{},{children:ue}))}),F=r,J=z,Y=F;Y.SearchSelect=J,Y.displayName="ProFormComponent",X.Z=Y},5966:function(ve,X,t){var U=t(1413),B=t(44925),K=t(85893),T=t(2123),$=["fieldProps","proFieldProps"],I=["fieldProps","proFieldProps"],V="text",h=function(F){var J=F.fieldProps,Y=F.proFieldProps,E=(0,B.Z)(F,$);return(0,K.jsx)(T.Z,(0,U.Z)({valueType:V,fieldProps:J,filedConfig:{valueType:V},proFieldProps:Y},E))},H=function(F){var J=F.fieldProps,Y=F.proFieldProps,E=(0,B.Z)(F,I);return(0,K.jsx)(T.Z,(0,U.Z)({valueType:"password",fieldProps:J,proFieldProps:Y,filedConfig:{valueType:V}},E))},r=h;r.Password=H,r.displayName="ProFormComponent",X.Z=r},90672:function(ve,X,t){var U=t(1413),B=t(44925),K=t(85893),T=t(67294),$=t(2123),I=["fieldProps","proFieldProps"],V=function(H,r){var z=H.fieldProps,F=H.proFieldProps,J=(0,B.Z)(H,I);return(0,K.jsx)($.Z,(0,U.Z)({ref:r,valueType:"textarea",fieldProps:z,proFieldProps:F},J))};X.Z=T.forwardRef(V)},9148:function(ve,X,t){t.r(X),t.d(X,{default:function(){return ia}});var U=t(56307),B=t.n(U),K=t(80164),T=t.n(K),$=t(74411),I=t.n($),V=t(55559),h=t.n(V),H=t(45223),r=t.n(H),z=t(34461),F=t(8609),J=t(79508),Y=t(54549),E=t(49101),ae=t(48705),re=t(51851),ue=t(20761),_=t(5966),te=t(90672),de=t(60415),v=t(95952),k=t(48086),ee=t(60331),ce=t(4107),W=t(50146),ne=t(71577),Oe=t(25084),Z=t(67294),De=t(19126),u=t(59070),Te=t(25680),Fe=t.n(Te),pe=t(92757),ye=t(62914),xe=t(79910),me=t(80703);function Se(w){return I()({id:(0,u.k$)(),type:u.Ak.AnchorType.INPUT,group:u.Ak.AnchorGroup.TOP,tooltip:"\u8F93\u5165\u6869"},w)}var Ie=(0,u.vD)(function(w){w.setRegisterHook(function(p){var o=[p.reactNodeRender.registerHook({name:"add react node",handler:function(){var i=h()(r().mark(function n(f){return r().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:f.set(pe.or,ye.E),f.set(pe.pN,xe.G);case 2:case"end":return c.stop()}},n)}));function a(n){return i.apply(this,arguments)}return a}()}),p.graphOptions.registerHook({name:"custom-x6-options",after:"dag-extension-x6-options",handler:function(){var i=h()(r().mark(function n(f){return r().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:f.grid=!1,f.keyboard={enabled:!0};case 2:case"end":return c.stop()}},n)}));function a(n){return i.apply(this,arguments)}return a}()}),p.x6Events.registerHook({name:"add",handler:function(){var i=h()(r().mark(function n(f){return r().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:f.push({eventName:"node:moved",callback:function(l,P){var s=l.node;P.executeCommand(u.cE.MOVE_NODE.id,{id:s.id,position:s.getPosition()})}},{eventName:"edge:added",callback:function(l,P){var s=l.edge.getTargetNode(),C=me.QK.getByPath(l,"options.isCommand","."),R=me.QK.getByPath(l,"options.isRenderGraph",".");!C||R||s&&P.executeCommand(u.cE.UPDATE_NODE_PORT.id,{node:s,updatePorts:function(){var g=h()(r().mark(function x(y){return r().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",[].concat(Fe()(y),[Se({})]));case 1:case"end":return A.stop()}},x)}));function S(x){return g.apply(this,arguments)}return S}()})}},{eventName:"edge:removed",callback:function(l,P){var s=l.edge.getTargetCellId(),C=l.edge.getTargetPortId(),R=me.QK.getByPath(l,"options.isCommand","."),g=me.QK.getByPath(l,"options.isRenderGraph",".");!R||g||P.executeCommand(u.cE.UPDATE_NODE_PORT.id,{node:s,updatePorts:function(){var S=h()(r().mark(function y(L){var A,G;return r().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return A=L.filter(function(le){return le.id!==C}),G=A.filter(function(le){return le.type===u.Ak.AnchorType.INPUT}),G.length===0&&A.push(Se({})),ie.abrupt("return",A);case 4:case"end":return ie.stop()}},y)}));function x(y){return S.apply(this,arguments)}return x}()})}});case 1:case"end":return c.stop()}},n)}));function a(n){return i.apply(this,arguments)}return a}()})],m=new u.K4;return m.pushAll(o),m})}),ke=t(91994),se;(function(w){var p=w.NODE_COMMON_PROPS={renderKey:pe.or,width:pe.nK,height:pe.M8},o=w.queryGraphMeta=function(){var c=h()(r().mark(function M(l){return r().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",I()(I()({},l),{},{flowId:l.meta.flowId}));case 1:case"end":return s.stop()}},M)}));return function(M){return c.apply(this,arguments)}}(),m=w.loadGraphData=function(){var c=h()(r().mark(function M(l){return r().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return console.log(l.meta.jobUID),s.next=3,(0,F.xI)({uid:l.flowId,jobUID:l.meta.jobUID});case 3:return s.abrupt("return",s.sent);case 4:case"end":return s.stop()}},M)}));return function(M){return c.apply(this,arguments)}}(),i=0,a={},n=u.yc.StatusEnum.DEFAULT,f=w.graphStatusService=h()(r().mark(function c(){return r().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i<4?(a["node".concat(i)]={status:u.yc.StatusEnum.SUCCESS},a["node".concat(i+1)]={status:u.yc.StatusEnum.PROCESSING},i+=1,n=u.yc.StatusEnum.PROCESSING):(i=0,a.node4={status:u.yc.StatusEnum.SUCCESS},n=u.yc.StatusEnum.SUCCESS),l.abrupt("return",{graphStatus:n,statusMap:a});case 2:case"end":return l.stop()}},c)})),d=w.stopGraphStatusService=h()(r().mark(function c(){return r().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return Object.entries(a).forEach(function(P){var s=T()(P,2),C=s[1],R=C,g=R.status;g===u.yc.StatusEnum.PROCESSING&&(C.status=u.yc.StatusEnum.ERROR)}),l.abrupt("return",{graphStatus:u.yc.StatusEnum.ERROR,statusMap:a});case 2:case"end":return l.stop()}},c)}))})(se||(se={}));var Re=(0,u.s4)(function(w){w.setCommandContributions(function(){return ke.m}),w.setRegisterHookFn(function(p){var o=[p.graphMeta.registerHook({name:"get graph meta from backend",handler:function(){var i=h()(r().mark(function n(f){return r().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:f.graphMetaService=se.queryGraphMeta;case 1:case"end":return c.stop()}},n)}));function a(n){return i.apply(this,arguments)}return a}()})],m=new u.K4;return m.pushAll(o),m})}),Pe=function(p){p.executeCommandPipeline([{commandId:u.Gv.LOAD_DATA.id,getCommandOption:function(){var o=h()(r().mark(function i(){return r().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",{args:{loadDataService:se.loadGraphData}});case 1:case"end":return n.stop()}},i)}));function m(){return o.apply(this,arguments)}return m}()},{commandId:u.Gv.GRAPH_LAYOUT.id,getCommandOption:function(){var o=h()(r().mark(function i(a){var n,f;return r().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return n=a.getResult(),f=n.graphData,c.abrupt("return",{args:{layoutType:"dagre",layoutOptions:{type:"dagre",rankdir:"TB",nodesep:60,ranksep:30},graphData:f}});case 2:case"end":return c.stop()}},i)}));function m(i){return o.apply(this,arguments)}return m}()},{commandId:u.Gv.GRAPH_RENDER.id,getCommandOption:function(){var o=h()(r().mark(function i(a){var n,f;return r().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return n=a.getResult(),f=n.graphData,c.abrupt("return",{args:{graphData:f}});case 2:case"end":return c.stop()}},i)}));function m(i){return o.apply(this,arguments)}return m}()},{commandId:u.Gv.GRAPH_ZOOM.id,getCommandOption:function(){var o=h()(r().mark(function i(){return r().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",{args:{factor:"fit",zoomOptions:{maxScale:.9}}});case 1:case"end":return n.stop()}},i)}));function m(){return o.apply(this,arguments)}return m}()}])},he;(function(w){var p=w.id="test"})(he||(he={}));var Le=(0,u.HJ)(function(w){w.registerModel(function(p){return p.registerModel({id:he.id,getInitialValue:function(){e:;}})})}),fa=null,Ae=t(92104),Ze=t(97254),Ue=t(18094),Ge=t(36371),Ne=t(50827),$e=t(54034),Ve=t(15360),We=t(24565),e=t(85893),fe;(function(w){u.ko.set("SaveOutlined",Ae.Z),u.ko.set("CloudSyncOutlined",Ze.Z),u.ko.set("GatewayOutlined",Ue.Z),u.ko.set("GroupOutlined",Ge.Z),u.ko.set("UngroupOutlined",Ne.Z),u.ko.set("PlaySquareOutlined",$e.Z),u.ko.set("StopOutlined",Ve.Z);var p=w.getDependencies=function(){var i=h()(r().mark(function a(n){return r().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,u.dX.SELECTED_CELLS.getModel(n);case 2:return d.t0=d.sent,d.next=5,u.dX.GRAPH_ENABLE_MULTI_SELECT.getModel(n);case 5:return d.t1=d.sent,d.next=8,u.yc.MODEL.getModel(n);case 8:return d.t2=d.sent,d.abrupt("return",[d.t0,d.t1,d.t2]);case 10:case"end":return d.stop()}},a)}));return function(a){return i.apply(this,arguments)}}(),o=w.getToolbarState=function(){var i=h()(r().mark(function a(n){var f,d,c,M,l;return r().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.dX.GRAPH_ENABLE_MULTI_SELECT.useValue(n);case 2:return f=s.sent,d=f.isEnable,s.next=6,u.dX.IS_GROUP_SELECTED.useValue(n);case 6:return c=s.sent,s.next=9,u.dX.IS_NORMAL_NODES_SELECTED.useValue(n);case 9:return M=s.sent,s.next=12,u.yc.MODEL.useValue(n);case 12:return l=s.sent,s.abrupt("return",{isNodeSelected:M,isGroupSelected:c,isMultiSelectionActive:d,isProcessing:l.graphStatus===u.yc.StatusEnum.PROCESSING});case 14:case"end":return s.stop()}},a)}));return function(a){return i.apply(this,arguments)}}(),m=w.getToolbarItems=function(){var i=h()(r().mark(function a(n){var f;return r().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return f=[],f.push({id:u.ho.QUERY_GRAPH_STATUS.id+"play",tooltip:"Restart execution",iconName:"PlaySquareOutlined",isEnabled:!n.isProcessing,onClick:function(){var M=h()(r().mark(function P(s){var C;return r().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:C=s.commandService,C.executeCommand(u.ho.QUERY_GRAPH_STATUS.id,{graphStatusService:se.graphStatusService,loopInterval:3e3});case 2:case"end":return g.stop()}},P)}));function l(P){return M.apply(this,arguments)}return l}()}),f.push({id:u.ho.QUERY_GRAPH_STATUS.id+"stop",tooltip:"Stop execution",iconName:"StopOutlined",isEnabled:n.isProcessing,onClick:function(){var M=h()(r().mark(function P(s){var C;return r().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:C=s.commandService,C.executeCommand(u.ho.QUERY_GRAPH_STATUS.id,{graphStatusService:se.stopGraphStatusService,loopInterval:5e3});case 2:case"end":return g.stop()}},P)}));function l(P){return M.apply(this,arguments)}return l}(),render:function(l){return(0,e.jsx)(We.Z,{title:"Confirm stop execution\uFF1F",onConfirm:function(){l.onClick()},children:l.children})}}),c.abrupt("return",[{name:"customCmd",items:f}]);case 4:case"end":return c.stop()}},a)}));return function(a){return i.apply(this,arguments)}}()})(fe||(fe={}));var Be=(0,u.iR)(function(w){w.setToolbarModelService(function(){var p=h()(r().mark(function o(m,i,a){var n,f,d;return r().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return n=function(){var l=h()(r().mark(function P(){var s,C;return r().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,fe.getToolbarState(i);case 2:return s=g.sent,g.next=5,fe.getToolbarItems(s);case 5:C=g.sent,m.setValue(function(S){S.mainGroups=C});case 7:case"end":return g.stop()}},P)}));return function(){return l.apply(this,arguments)}}(),M.next=3,fe.getDependencies(i);case 3:f=M.sent,d=f.map(function(l){return l.watch(h()(r().mark(function P(){return r().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:n();case 1:case"end":return C.stop()}},P)})))}),a.pushAll(d);case 6:case"end":return M.stop()}},o)}));return function(o,m,i){return p.apply(this,arguments)}}())}),oe=t(72116),Ke=t(76888),He=t(68564),Je=t(26904);function ma(w){return new Promise(function(p){return setTimeout(function(){return p(!0)},w)})}var Ye=function(){var w=h()(r().mark(function p(o){var m,i,a,n,f,d,c,M,l,P,s,C,R;return r().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return n=o.modelService,f=o.targetType,S.next=3,u.dX.GRAPH_META.useValue(n);case 3:if(d=S.sent,f!=="canvas"){S.next=6;break}return S.abrupt("return",{tabs:[{name:"DagMeta",groups:[{name:"groupName",controls:[{name:"workflowUID",label:"Workflow UID",shape:"Input",disabled:!0,required:!0,tooltip:"Workflow UID",extra:"",placeholder:"workflow uid",value:"",defaultValue:d.flowId,hidden:!1,options:[{title:"",value:""}],originData:{}},{label:"Graph data",name:"graphJSON",shape:oe.Y.EDITOR,disabled:!1,required:!0,tooltip:"JSON \u6570\u636E",placeholder:"JSON \u6570\u636E",value:"",defaultValue:"",hidden:!1,options:[{title:"",value:""}],originData:{}},{label:"View log link",name:"log",shape:oe.Y.LINKSHAPE,disabled:!1,required:!0,tooltip:"log link",placeholder:"log link",value:"",defaultValue:"",hidden:!1,options:[{title:"",value:""}],originData:{}}]}]}]});case 6:return S.next=8,(0,Ke.NQ)();case 8:return c=S.sent,S.next=11,(0,Je.Xn)();case 11:return M=S.sent,S.next=14,(0,He.Pb)();case 14:return l=S.sent,P=[],c!=null&&c.items!=null&&c.items.forEach(function(x){P.push({label:x.name,value:x.uid})}),s=[],M!=null&&M.items!=null&&M.items.forEach(function(x){s.push({label:x.name,value:x.uid})}),C=[],l!=null&&l.items!=null&&l.items.forEach(function(x){C.push({label:x.name,value:x.uid})}),R={tabs:[{name:"NodeMeta",groups:[{name:"nodeName",controls:[{label:"Code",name:"code",shape:oe.Y.SELECTOR,disabled:!0,required:!0,tooltip:"The code to be run by the compute node",placeholder:"please select code",value:(m=o.targetData)===null||m===void 0?void 0:m.code,defaultValue:"",hidden:!1,options:P,originData:{}},{label:"Variables",name:"variables",shape:oe.Y.SELECTOR,disabled:!0,required:!1,tooltip:"Variables loaded by compute nodes",placeholder:"please select connections",value:(i=o.targetData)===null||i===void 0?void 0:i.variables,defaultValue:"",hidden:!1,options:s,originData:{}},{label:"Connections",name:"connections",shape:oe.Y.SELECTOR,disabled:!0,required:!1,tooltip:"Connections loaded by compute nodes",placeholder:"please select connections",value:(a=o.targetData)===null||a===void 0?void 0:a.connections,defaultValue:"",hidden:!1,options:C,originData:{}}]}]}]},S.abrupt("return",R);case 23:case"end":return S.stop()}},p)}));return function(o){return w.apply(this,arguments)}}(),Qe=function(){var w=h()(r().mark(function p(){return r().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:case"end":return m.stop()}},p)}));return function(){return w.apply(this,arguments)}}(),ga=t(195),va=t(22970),Xe=function(p){var o=p.meta,m=Ie(p),i=Be(),a=Re(),n=Le(),f=Z.useMemo(function(){return{app:null}},[]),d=function(){var c=h()(r().mark(function M(l){return r().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:f.app=l,Pe(f.app);case 2:case"end":return s.stop()}},M)}));return function(l){return c.apply(this,arguments)}}();return Z.useEffect(function(){console.log(o.jobUID),f.app&&Pe(f.app)},[f,f.app,o.jobUID]),(0,e.jsxs)(u.g,{className:"dag-user-custom-clz",hookConfig:m,modelServiceConfig:n,commandConfig:a,onLoad:d,meta:{flowId:p.meta.flowId,jobUID:p.meta.jobUID},children:[(0,e.jsx)(u.ce,{}),(0,e.jsx)(u.xZ,{className:"xflow-workspace-toolbar-top",layout:"horizontal",config:i,position:{top:0,left:0,right:290,bottom:0}}),(0,e.jsxs)(u.n1,{position:{top:40,left:0,right:290,bottom:0},children:[(0,e.jsx)(u.It,{position:{top:12,right:12}}),(0,e.jsx)(u.XS,{color:"#faad14"})]}),(0,e.jsx)(u.Ip,{controlMapService:oe.O,formSchemaService:Ye,formValueUpdateService:Qe,bodyPosition:{top:0,bottom:0,right:0},position:{width:290,top:0,bottom:0,right:0},footerPosition:{height:0}})]})},ha=null,ze=function(p){var o=(0,Z.useRef)(),m=(0,Z.useState)(),i=T()(m,2),a=i[0],n=i[1];Z.useEffect(function(){var y;(y=o.current)===null||y===void 0||y.reload()},[p.uid]);var f=(0,Z.useState)(!1),d=T()(f,2),c=d[0],M=d[1],l=(0,Z.useState)(!1),P=T()(l,2),s=P[0],C=P[1],R=function(){M(!0)},g=function(){C(!0)},S=function(){n(void 0),M(!1),C(!1)},x=[{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.uid",defaultMessage:"UID"}),dataIndex:"uid",tip:"The uid is the unique key"},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.jobList.name",defaultMessage:"Job name"}),dataIndex:"name"},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.state",defaultMessage:"State"}),dataIndex:"state",renderText:function(L){return(0,e.jsx)(ee.Z,{color:L=="failed"?"orange":L=="success"?"green":"blue",children:L})}},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.jobList.workflowUID",defaultMessage:"Workflow UID"}),dataIndex:"workflowUID"},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.jobList.completionTimestamp",defaultMessage:"Completion time"}),dataIndex:"completionTimestamp",valueType:"dateTime"},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.creationTimestamp",defaultMessage:"Created time"}),dataIndex:"creationTimestamp",valueType:"dateTime"},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(L,A){return[(0,e.jsx)("a",{onClick:function(){n(A),R()},children:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.events",defaultMessage:"Events"})},"events"),(0,e.jsx)("a",{onClick:function(){n(A),g()},children:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.dagState",defaultMessage:"Dag state"})},"dag")]}}];return(0,e.jsxs)("div",{children:[(0,e.jsx)(re.Z,{rowKey:"uid",search:!1,actionRef:o,request:h()(r().mark(function y(){var L;return r().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,(0,De.qE)({uid:p.uid});case 2:return L=G.sent,G.abrupt("return",{data:L.items,success:!0});case 4:case"end":return G.stop()}},y)})),columns:x}),(0,e.jsx)(W.Z,{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.events",defaultMessage:"Events"}),width:1500,visible:c,onOk:S,onCancel:S,children:a?.uid&&(0,e.jsx)(z.Z,{uid:a?.uid})}),(0,e.jsx)(W.Z,{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.events",defaultMessage:"Events"}),width:1500,visible:s,onOk:S,onCancel:S,children:a?.workflowUID&&(0,e.jsx)(Xe,{meta:{flowId:a?.workflowUID,jobUID:a?.uid}})})]})},qe=ze,we=t(43110),_e=t(64317),ea=function(p){var o=(0,v.useIntl)();return(0,e.jsxs)(we.L,{stepsProps:{size:"small"},stepsFormRender:function(i,a){return(0,e.jsx)(W.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:o.formatMessage({id:"pages.workflowList.form.workflowConfig",defaultMessage:"\u5DE5\u4F5C\u6D41\u914D\u7F6E"}),visible:p.updateModalVisible,footer:a,onCancel:function(){p.onCancel()},children:i})},onFinish:function(){var m=h()(r().mark(function i(a){return r().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(a.trigger!="cron"){f.next=4;break}if(!(a.triggerParam==null||a.triggerParam=="")){f.next=4;break}return k.ZP.warn("\u8BF7\u8BBE\u7F6E\u5B9A\u65F6\u89C4\u5219\uFF01"),f.abrupt("return",!1);case 4:return f.next=6,p.onSubmit(I()(I()({},p.values),a));case 6:return f.abrupt("return",!0);case 7:case"end":return f.stop()}},i)}));return function(i){return m.apply(this,arguments)}}(),children:[(0,e.jsxs)(we.L.StepForm,{initialValues:{name:p.values.name,describe:p.values.describe},title:o.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),children:[(0,e.jsx)(_.Z,{name:"name",label:o.formatMessage({id:"pages.workflowList.form.name",defaultMessage:"\u5DE5\u4F5C\u6D41\u540D\u79F0"}),width:"md",rules:[{required:!0,message:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.ruleName",defaultMessage:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u6D41\u540D\u79F0\uFF01"})}]}),(0,e.jsx)(te.Z,{name:"describe",width:"md",label:o.formatMessage({id:"pages.workflowList.form.describe",defaultMessage:"\u5DE5\u4F5C\u6D41\u63CF\u8FF0"}),placeholder:o.formatMessage({id:"pages.workflowList.form.describe.descPlaceholder",defaultMessage:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u6D41\u63CF\u8FF0"}),rules:[{required:!0,message:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.form.describe.descPlaceholder",defaultMessage:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u6D41\u63CF\u8FF0\uFF01"}),min:1}]})]}),(0,e.jsxs)(we.L.StepForm,{initialValues:{trigger:p.values.trigger,triggerParam:p.values.triggerParam},title:o.formatMessage({id:"pages.workflowList.form.trigger.title",defaultMessage:"\u8BBE\u5B9A\u8C03\u5EA6\u65B9\u5F0F"}),children:[(0,e.jsx)(_e.Z,{name:"trigger",label:o.formatMessage({id:"pages.workflowList.form.trigger",defaultMessage:"\u8C03\u5EA6\u65B9\u5F0F"}),width:"md",valueEnum:{manual:o.formatMessage({id:"pages.workflowList.trigger.manual"}),cron:o.formatMessage({id:"pages.workflowList.trigger.cron"})},rules:[{required:!0,message:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.form.trigger.rule",defaultMessage:"\u8BF7\u9009\u62E9\u8C03\u5EA6\u65B9\u5F0F\uFF01"})}]}),(0,e.jsx)(_.Z,{name:"triggerParam",label:o.formatMessage({id:"pages.workflowList.form.cron",defaultMessage:"\u5B9A\u65F6\u89C4\u5219"}),width:"md",rules:[{required:!1,message:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.form.cron.rule",defaultMessage:"\u8BF7\u8F93\u5165\u5B9A\u65F6\u89C4\u5219\uFF01"})}]})]})]})},aa=ea,ra=["defaultRender"],ta=function(){var w=h()(r().mark(function p(o){var m,i,a,n;return r().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return m=k.ZP.loading("Adding"),d.prev=1,i="workflow",a="v1",n=!0,d.next=7,(0,F.g4)(I()(I()({},o),{},{kind:i,apiVersion:a,active:n}));case 7:return m(),k.ZP.success("Added successfully"),d.abrupt("return",!0);case 12:return d.prev=12,d.t0=d.catch(1),m(),k.ZP.error("Adding failed, please try again!"),d.abrupt("return",!1);case 17:case"end":return d.stop()}},p,null,[[1,12]])}));return function(o){return w.apply(this,arguments)}}(),na=function(){var w=h()(r().mark(function p(o){var m;return r().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return m=k.ZP.loading("Updating"),a.prev=1,a.next=4,(0,F.NS)({uid:o.uid},o);case 4:return m(),k.ZP.success("Update is successful"),a.abrupt("return",!0);case 9:return a.prev=9,a.t0=a.catch(1),m(),k.ZP.error("Update failed, please try again!"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},p,null,[[1,9]])}));return function(o){return w.apply(this,arguments)}}(),sa=function(){var w=h()(r().mark(function p(o){var m;return r().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(m=k.ZP.loading("deleting"),o){a.next=3;break}return a.abrupt("return",!0);case 3:return a.prev=3,a.next=6,(0,F.oJ)({uid:"-"});case 6:return m(),k.ZP.success("Deleted successfully and will refresh soon"),a.abrupt("return",!0);case 11:return a.prev=11,a.t0=a.catch(3),m(),k.ZP.error("Delete failed, please try again"),a.abrupt("return",!1);case 16:case"end":return a.stop()}},p,null,[[3,11]])}));return function(o){return w.apply(this,arguments)}}(),oa=function(){var p=(0,Z.useState)(!1),o=T()(p,2),m=o[0],i=o[1],a=(0,Z.useState)(!1),n=T()(a,2),f=n[0],d=n[1],c=(0,Z.useState)(!1),M=T()(c,2),l=M[0],P=M[1],s=(0,Z.useRef)(),C=(0,Z.useState)(),R=T()(C,2),g=R[0],S=R[1],x=(0,Z.useState)([]),y=T()(x,2),L=y[0],A=y[1],G=(0,Z.useState)(!1),Me=T()(G,2),ie=Me[0],le=Me[1],la=(0,Z.useState)(!1),Ce=T()(la,2),ua=Ce[0],Ee=Ce[1],da=function(){le(!0)},ca=function(){Ee(!0)},ge=function(){S(void 0),le(!1),Ee(!1)},pa=(0,v.useNavigate)(),q=(0,v.useIntl)(),be=[{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.uid",defaultMessage:"UID"}),dataIndex:"uid",tip:"The uid is the unique key",render:function(j,b){return(0,e.jsx)("a",{onClick:function(){S(b),P(!0)},children:j})}},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.form.workflowName.nameLabel",defaultMessage:"Workflow name"}),dataIndex:"name"},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.titleDesc",defaultMessage:"Description"}),dataIndex:"describe",valueType:"textarea"},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.titleActive",defaultMessage:"Is active"}),dataIndex:"active",hideInForm:!0,renderText:function(j){return j?(0,e.jsx)(J.Z,{}):(0,e.jsx)(Y.Z,{})}},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.trigger",defaultMessage:"Trigger"}),dataIndex:"trigger",hideInForm:!0,valueEnum:{manual:{text:(0,e.jsx)(ee.Z,{color:"orange",children:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.trigger.manual",defaultMessage:"Manual"})}),status:"manual"},cron:{text:(0,e.jsx)(ee.Z,{color:"blue",children:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.trigger.cron",defaultMessage:"Cron"})}),status:"cron"}}},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.titleUpdatedAt",defaultMessage:"Last scheduled time"}),sorter:!0,dataIndex:"lastTriggerTimestamp",valueType:"dateTime",renderFormItem:function(j,b,O){var Q=b.defaultRender,N=B()(b,ra),je=O.getFieldValue("status");return"".concat(je)==="0"?!1:"".concat(je)==="3"?(0,e.jsx)(ce.Z,I()(I()({},N),{},{placeholder:q.formatMessage({id:"pages.searchTable.exception",defaultMessage:"Please enter the reason for the exception!"})})):Q(j)}},{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(j,b){return[(0,e.jsx)("a",{onClick:function(){W.Z.confirm({title:q.formatMessage({id:"pages.workflowList.confirmSchedule",defaultMessage:"Confirm schedule now?"}),onOk:function(){(0,F.Zc)({uid:b.uid}).then(function(){k.ZP.info(q.formatMessage({id:"pages.workflowList.scheduleSuccess"}))}).catch(function(){k.ZP.error(q.formatMessage({id:"pages.workflowList.scheduleFailed"}))})}})},children:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.scheduleNow",defaultMessage:"Schedule now"})},"run"),(0,e.jsx)("a",{onClick:function(){d(!0),S(b)},children:(0,e.jsx)(v.FormattedMessage,{id:"pages.searchTable.config",defaultMessage:"Configuration"})},"config"),(0,e.jsx)("a",{onClick:function(){pa("/workflow/".concat(b.uid,"/dag"),{replace:!0})},children:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.dag",defaultMessage:"DAG"})},"dag"),(0,e.jsx)("a",{onClick:function(){S(b),da()},children:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.events",defaultMessage:"Events"})},"events"),(0,e.jsx)("a",{onClick:function(){S(b),ca()},children:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.jobs",defaultMessage:"Jobs"})},"jobs")]}}];return(0,e.jsxs)(ae._z,{children:[(0,e.jsx)(re.Z,{headerTitle:q.formatMessage({id:"pages.common.tableTitle",defaultMessage:"Enquiry form"}),actionRef:s,rowKey:"uid",search:{labelWidth:120},toolBarRender:function(){return[(0,e.jsxs)(ne.Z,{type:"primary",onClick:function(){i(!0)},children:[(0,e.jsx)(E.Z,{})," ",(0,e.jsx)(v.FormattedMessage,{id:"pages.common.new",defaultMessage:"New"})]},"primary")]},request:h()(r().mark(function D(){var j;return r().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,F.gI)();case 2:return j=O.sent,O.abrupt("return",{data:j.items,success:!0});case 4:case"end":return O.stop()}},D)})),columns:be,rowSelection:{onChange:function(j,b){A(b)}}}),L?.length>0&&(0,e.jsx)(ae.Sc,{extra:(0,e.jsxs)("div",{children:[(0,e.jsx)(v.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,e.jsx)("a",{style:{fontWeight:600},children:L.length})," ",(0,e.jsx)(v.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"})]}),children:(0,e.jsx)(ne.Z,{onClick:h()(r().mark(function D(){var j,b;return r().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,sa(L);case 2:A([]),(j=s.current)===null||j===void 0||(b=j.reloadAndRest)===null||b===void 0||b.call(j);case 4:case"end":return Q.stop()}},D)})),children:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,e.jsxs)(ue.Y,{title:q.formatMessage({id:"pages.workflowList.form.newWorkflow",defaultMessage:"New workflow"}),width:"400px",visible:m,onVisibleChange:i,onFinish:function(){var D=h()(r().mark(function j(b){var O;return r().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,ta(b);case 2:O=N.sent,O&&(i(!1),s.current&&s.current.reload());case 4:case"end":return N.stop()}},j)}));return function(j){return D.apply(this,arguments)}}(),children:[(0,e.jsx)(_.Z,{rules:[{required:!0,message:(0,e.jsx)(v.FormattedMessage,{id:"pages.workflowList.ruleName",defaultMessage:"Workflow name is required"})}],width:"md",name:"name",placeholder:q.formatMessage({id:"pages.workflowList.form.name",defaultMessage:"Workflow name"})}),(0,e.jsx)(te.Z,{width:"md",name:"describe",placeholder:q.formatMessage({id:"pages.workflowList.form.describe",defaultMessage:"Workflow describe"})})]}),(0,e.jsx)(aa,{onSubmit:function(){var D=h()(r().mark(function j(b){var O;return r().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,na(b);case 2:O=N.sent,O&&(d(!1),S(void 0),s.current&&s.current.reload());case 4:case"end":return N.stop()}},j)}));return function(j){return D.apply(this,arguments)}}(),onCancel:function(){d(!1),l||S(void 0)},updateModalVisible:f,values:g||{}}),(0,e.jsx)(Oe.Z,{width:600,visible:l,onClose:function(){S(void 0),P(!1)},closable:!1,children:g?.uid&&(0,e.jsx)(de.vY,{column:2,title:g?.uid,request:h()(r().mark(function D(){return r().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",{data:g||{}});case 1:case"end":return b.stop()}},D)})),params:{id:g?.uid},columns:be})}),(0,e.jsx)(W.Z,{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.events",defaultMessage:"Events"}),width:1500,visible:ie,onOk:ge,onCancel:ge,children:g?.uid&&(0,e.jsx)(z.Z,{uid:g?.uid})}),(0,e.jsx)(W.Z,{title:(0,e.jsx)(v.FormattedMessage,{id:"pages.common.jobs",defaultMessage:"Jobs"}),width:1500,visible:ua,onOk:ge,onCancel:ge,children:g?.uid&&(0,e.jsx)(qe,{uid:g?.uid})})]})},ia=oa}}]);
