"use strict";(self.webpackChunkflowline_admin=self.webpackChunkflowline_admin||[]).push([[366],{5966:function(X,B,e){var E=e(1413),j=e(44925),D=e(85893),M=e(2123),z=["fieldProps","proFieldProps"],b=["fieldProps","proFieldProps"],L="text",p=function(r){var F=r.fieldProps,T=r.proFieldProps,Z=(0,j.Z)(r,z);return(0,D.jsx)(M.Z,(0,E.Z)({valueType:L,fieldProps:F,filedConfig:{valueType:L},proFieldProps:T},Z))},V=function(r){var F=r.fieldProps,T=r.proFieldProps,Z=(0,j.Z)(r,b);return(0,D.jsx)(M.Z,(0,E.Z)({valueType:"password",fieldProps:F,proFieldProps:T,filedConfig:{valueType:L}},Z))},S=p;S.Password=V,S.displayName="ProFormComponent",B.Z=S},93950:function(X,B,e){e.r(B),e.d(B,{default:function(){return ie}});var E=e(74411),j=e.n(E),D=e(55559),M=e.n(D),z=e(80164),b=e.n(z),L=e(45223),p=e.n(L),V=e(32131),S=e(30967),c=e(1413),r=e(67294),F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},T=F,Z=e(27029),Q=function(f,l){return r.createElement(Z.Z,(0,c.Z)((0,c.Z)({},f),{},{ref:l,icon:T}))};Q.displayName="LockOutlined";var k=r.forwardRef(Q),q=e(89366),ue=e(97238),_=e(75901),ee=e(44925),s=e(85893),se=e(78775),ae=e(63436),te=["logo","message","contentStyle","title","subTitle","actions","children"];function re(i){var f,l=i.logo,A=i.message,W=i.contentStyle,I=i.title,N=i.subTitle,O=i.actions,K=i.children,n=(0,ee.Z)(i,te),y=(0,se.YB)(),R=n.submitter===!1?!1:(0,c.Z)((0,c.Z)({searchConfig:{submitText:y.getMessage("loginForm.submitText","\u767B\u5F55")}},n.submitter),{},{submitButtonProps:(0,c.Z)({size:"large",style:{width:"100%"}},(f=n.submitter)===null||f===void 0?void 0:f.submitButtonProps),render:function(h,u){var d,o=u.pop();if(typeof(n==null||(d=n.submitter)===null||d===void 0?void 0:d.render)=="function"){var a,g;return n==null||(a=n.submitter)===null||a===void 0||(g=a.render)===null||g===void 0?void 0:g.call(a,h,u)}return o}}),m=(0,r.useContext)(_.ZP.ConfigContext),G=m.getPrefixCls("pro-form-login"),v=function(h){return"".concat(G,"-").concat(h)},U=(0,r.useMemo)(function(){return l?typeof l=="string"?(0,s.jsx)("img",{src:l}):l:null},[l]);return(0,s.jsxs)("div",{className:v("container"),children:[(0,s.jsxs)("div",{className:v("top"),children:[I||U?(0,s.jsxs)("div",{className:v("header"),children:[U?(0,s.jsx)("span",{className:v("logo"),children:U}):null,I?(0,s.jsx)("span",{className:v("title"),children:I}):null]}):null,N?(0,s.jsx)("div",{className:v("desc"),children:N}):null]}),(0,s.jsxs)("div",{className:v("main"),style:(0,c.Z)({width:328},W),children:[(0,s.jsxs)(ae.A,(0,c.Z)((0,c.Z)({isKeyPressSubmit:!0},n),{},{submitter:R,children:[A,K]})),O?(0,s.jsx)("div",{className:v("other"),children:O}):null]})]})}var Y=e(5966),x=e(95952),ne=e(76772),$=e(48086),J=e(51752),C={container:"container___Gu7OB",lang:"lang___T6zNf",content:"content____mgVA",icon:"icon___VFrN1"},le=function(f){var l=f.content;return(0,s.jsx)(ne.Z,{style:{marginBottom:24},message:l,type:"error",showIcon:!0})},oe=function(){var f=(0,r.useState)({}),l=b()(f,2),A=l[0],W=l[1],I=(0,r.useState)("account"),N=b()(I,2),O=N[0],K=N[1],n=(0,x.useModel)("@@initialState"),y=n.initialState,R=n.setInitialState,m=(0,x.useIntl)(),G=function(){var h=M()(p().mark(function u(d,o){var a,g;return p().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,y==null||(a=y.fetchUserInfo)===null||a===void 0?void 0:a.call(y,d);case 2:if(g=P.sent,!g){P.next=6;break}return P.next=6,R(function(t){return j()(j()({},t),{},{currentUserToken:o,currentUser:g})});case 6:case"end":return P.stop()}},u)}));return function(d,o){return h.apply(this,arguments)}}(),v=function(){var h=M()(p().mark(function u(d){var o,a,g,w;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,S.uQ)(j()({},d));case 3:if(o=t.sent,o.token===""){t.next=14;break}return sessionStorage.setItem("uid",o.userUID),sessionStorage.setItem("token",o.token),a=m.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),$.ZP.success(a),t.next=11,G(o.userUID,o.token);case 11:return g=new URL(window.location.href).searchParams,x.history.push(g.get("redirect")||"/"),t.abrupt("return");case 14:W({type:"account",status:"error"}),t.next=22;break;case 17:t.prev=17,t.t0=t.catch(0),w=m.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(t.t0),$.ZP.error(w);case 22:case"end":return t.stop()}},u,null,[[0,17]])}));return function(d){return h.apply(this,arguments)}}(),U=A.status,H=A.type;return(0,s.jsxs)("div",{className:C.container,children:[(0,s.jsx)("div",{className:C.lang,"data-lang":!0,children:x.SelectLang&&(0,s.jsx)(x.SelectLang,{})}),(0,s.jsx)("div",{className:C.content,children:(0,s.jsxs)(re,{logo:(0,s.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"Flowline",subTitle:m.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},onFinish:function(){var h=M()(p().mark(function u(d){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v(d);case 2:case"end":return a.stop()}},u)}));return function(u){return h.apply(this,arguments)}}(),children:[(0,s.jsx)(J.Z,{activeKey:O,onChange:K,children:(0,s.jsx)(J.Z.TabPane,{tab:m.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account")}),U==="error"&&H==="account"&&(0,s.jsx)(le,{content:m.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),O==="account"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Y.Z,{name:"username",fieldProps:{size:"large",prefix:(0,s.jsx)(q.Z,{className:C.prefixIcon})},placeholder:m.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D"}),rules:[{required:!0,message:(0,s.jsx)(x.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,s.jsx)(Y.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,s.jsx)(k,{className:C.prefixIcon})},placeholder:m.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801"}),rules:[{required:!0,message:(0,s.jsx)(x.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]})]})}),(0,s.jsx)(V.Z,{})]})},ie=oe}}]);
