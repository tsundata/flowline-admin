"use strict";(self.webpackChunkflowline_admin=self.webpackChunkflowline_admin||[]).push([[366],{5966:function(X,O,e){var E=e(1413),f=e(45987),B=e(85893),j=e(69553),b=["fieldProps","proFieldProps"],y=["fieldProps","proFieldProps"],L="text",D=function(t){var c=t.fieldProps,F=t.proFieldProps,T=(0,f.Z)(t,b);return(0,B.jsx)(j.Z,(0,E.Z)({valueType:L,fieldProps:c,filedConfig:{valueType:L},proFieldProps:F},T))},R=function(t){var c=t.fieldProps,F=t.proFieldProps,T=(0,f.Z)(t,y);return(0,B.jsx)(j.Z,(0,E.Z)({valueType:"password",fieldProps:c,proFieldProps:F,filedConfig:{valueType:L}},T))},S=D;S.Password=R,S.displayName="ProFormComponent",O.Z=S},19599:function(X,O,e){e.r(O),e.d(O,{default:function(){return ie}});var E=e(97983),f=e.n(E),B=e(11281),j=e.n(B),b=e(40794),y=e.n(b),L=e(12741),D=e.n(L),R=e(26442),S=e(62417),z=e(87547),t=e(1413),c=e(67294),F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},T=F,k=e(84089),Q=function(m,l){return c.createElement(k.Z,(0,t.Z)((0,t.Z)({},m),{},{ref:l,icon:T}))};Q.displayName="LockOutlined";var q=c.forwardRef(Q),ue=e(78924),_=e(37569),ee=e(45987),s=e(85893),se=e(18888),te=e(83962),ae=["logo","message","contentStyle","title","subTitle","actions","children"];function re(i){var m,l=i.logo,A=i.message,W=i.contentStyle,I=i.title,C=i.subTitle,U=i.actions,K=i.children,n=(0,ee.Z)(i,ae),M=(0,se.YB)(),V=n.submitter===!1?!1:(0,t.Z)((0,t.Z)({searchConfig:{submitText:M.getMessage("loginForm.submitText","\u767B\u5F55")}},n.submitter),{},{submitButtonProps:(0,t.Z)({size:"large",style:{width:"100%"}},(m=n.submitter)===null||m===void 0?void 0:m.submitButtonProps),render:function(p,u){var d,o=u.pop();if(typeof(n==null||(d=n.submitter)===null||d===void 0?void 0:d.render)=="function"){var a,g;return n==null||(a=n.submitter)===null||a===void 0||(g=a.render)===null||g===void 0?void 0:g.call(a,p,u)}return o}}),h=(0,c.useContext)(_.ZP.ConfigContext),H=h.getPrefixCls("pro-form-login"),v=function(p){return"".concat(H,"-").concat(p)},N=(0,c.useMemo)(function(){return l?typeof l=="string"?(0,s.jsx)("img",{src:l}):l:null},[l]);return(0,s.jsxs)("div",{className:v("container"),children:[(0,s.jsxs)("div",{className:v("top"),children:[I||N?(0,s.jsxs)("div",{className:v("header"),children:[N?(0,s.jsx)("span",{className:v("logo"),children:N}):null,I?(0,s.jsx)("span",{className:v("title"),children:I}):null]}):null,C?(0,s.jsx)("div",{className:v("desc"),children:C}):null]}),(0,s.jsxs)("div",{className:v("main"),style:(0,t.Z)({width:328},W),children:[(0,s.jsxs)(te.A,(0,t.Z)((0,t.Z)({isKeyPressSubmit:!0},n),{},{submitter:V,children:[A,K]})),U?(0,s.jsx)("div",{className:v("other"),children:U}):null]})]})}var Y=e(5966),P=e(36275),ne=e(14670),$=e(12461),J=e(96619),Z={container:"container___REQAy",lang:"lang___DAjLY",content:"content___IkUx1",icon:"icon___fqAhh"},le=function(m){var l=m.content;return(0,s.jsx)(ne.Z,{style:{marginBottom:24},message:l,type:"error",showIcon:!0})},oe=function(){var m=(0,c.useState)({}),l=D()(m,2),A=l[0],W=l[1],I=(0,c.useState)("account"),C=D()(I,2),U=C[0],K=C[1],n=(0,P.useModel)("@@initialState"),M=n.initialState,V=n.setInitialState,h=(0,P.useIntl)(),H=function(){var p=y()(f()().mark(function u(d,o){var a,g;return f()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,M==null||(a=M.fetchUserInfo)===null||a===void 0?void 0:a.call(M,d);case 2:if(g=x.sent,!g){x.next=6;break}return x.next=6,V(function(r){return j()(j()({},r),{},{currentUserToken:o,currentUser:g})});case 6:case"end":return x.stop()}},u)}));return function(d,o){return p.apply(this,arguments)}}(),v=function(){var p=y()(f()().mark(function u(d){var o,a,g,G;return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,S.uQ)(j()({},d));case 3:if(o=r.sent,o.token===""){r.next=14;break}return sessionStorage.setItem("uid",o.userUID),sessionStorage.setItem("token",o.token),a=h.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),$.ZP.success(a),r.next=11,H(o.userUID,o.token);case 11:return g=new URL(window.location.href).searchParams,P.history.push(g.get("redirect")||"/"),r.abrupt("return");case 14:W({type:"account",status:"error"}),r.next=21;break;case 17:r.prev=17,r.t0=r.catch(0),G=h.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),$.ZP.error(G);case 21:case"end":return r.stop()}},u,null,[[0,17]])}));return function(d){return p.apply(this,arguments)}}(),N=A.status,w=A.type;return(0,s.jsxs)("div",{className:Z.container,children:[(0,s.jsx)("div",{className:Z.lang,"data-lang":!0,children:P.SelectLang&&(0,s.jsx)(P.SelectLang,{})}),(0,s.jsx)("div",{className:Z.content,children:(0,s.jsxs)(re,{logo:(0,s.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"Flowline",subTitle:h.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},onFinish:function(){var p=y()(f()().mark(function u(d){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v(d);case 2:case"end":return a.stop()}},u)}));return function(u){return p.apply(this,arguments)}}(),children:[(0,s.jsx)(J.Z,{activeKey:U,onChange:K,children:(0,s.jsx)(J.Z.TabPane,{tab:h.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account")}),N==="error"&&w==="account"&&(0,s.jsx)(le,{content:h.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),U==="account"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Y.Z,{name:"username",fieldProps:{size:"large",prefix:(0,s.jsx)(z.Z,{className:Z.prefixIcon})},placeholder:h.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D"}),rules:[{required:!0,message:(0,s.jsx)(P.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,s.jsx)(Y.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,s.jsx)(q,{className:Z.prefixIcon})},placeholder:h.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801"}),rules:[{required:!0,message:(0,s.jsx)(P.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]})]})}),(0,s.jsx)(R.Z,{})]})},ie=oe}}]);
