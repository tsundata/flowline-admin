"use strict";(self.webpackChunkflowline_admin=self.webpackChunkflowline_admin||[]).push([[382],{5966:function(ee,U,e){var A=e(1413),M=e(45987),W=e(85893),l=e(69553),G=["fieldProps","proFieldProps"],P=["fieldProps","proFieldProps"],D="text",h=function(y){var S=y.fieldProps,O=y.proFieldProps,x=(0,M.Z)(y,G);return(0,W.jsx)(l.Z,(0,A.Z)({valueType:D,fieldProps:S,filedConfig:{valueType:D},proFieldProps:O},x))},T=function(y){var S=y.fieldProps,O=y.proFieldProps,x=(0,M.Z)(y,P);return(0,W.jsx)(l.Z,(0,A.Z)({valueType:"password",fieldProps:S,proFieldProps:O,filedConfig:{valueType:D}},x))},F=h;F.Password=T,F.displayName="ProFormComponent",U.Z=F},43495:function(ee,U,e){e.r(U),e.d(U,{default:function(){return m}});var A=e(12741),M=e.n(A),W=e(97983),l=e.n(W),G=e(11281),P=e.n(G),D=e(40794),h=e.n(D),T=e(53912),F=e(24969),K=e(52077),y=e(20397),S=e(62876),O=e(78091),x=e(5966),k=e(7338),g=e(36275),_=e(12461),Z=e(71577),V=e(63463),L=e(67294),N=e(83962),re=e(85402),I=e(80737),Q=e(34041),r=e(85893),X=function(a){var u=(0,g.useIntl)(),t=[{label:"GET",value:"GET"},{label:"LIST",value:"LIST"},{label:"WATCH",value:"WATCH"},{label:"POST",value:"POST"},{label:"PATCH",value:"PATCH"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"}],c=[{label:"code",value:"code"},{label:"connection",value:"connection"},{label:"dag",value:"dag"},{label:"job",value:"job"},{label:"role",value:"role"},{label:"user",value:"user"},{label:"variable",value:"variable"},{label:"workflow",value:"workflow"},{label:"event",value:"event"},{label:"stage",value:"stage"},{label:"worker",value:"worker"}];return(0,r.jsx)(re.Z,{width:800,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:u.formatMessage({id:"pages.roleList.form.roleConfig",defaultMessage:"\u7528\u6237\u7F16\u8F91"}),open:a.updateModalVisible,onCancel:function(){a.onCancel()},footer:null,children:(0,r.jsxs)(N.A,{initialValues:{name:a.values.name,verbs:a.values.verbs,resources:a.values.resources},title:u.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),onFinish:function(){var s=h()(l()().mark(function R(f){return l()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,a.onSubmit(P()(P()({},a.values),f));case 2:return C.abrupt("return",!0);case 3:case"end":return C.stop()}},R)}));return function(R){return s.apply(this,arguments)}}(),submitter:{submitButtonProps:{},render:function(R){return[(0,r.jsx)(Z.Z,{type:"primary",onClick:function(){var j,C;return(j=R.form)===null||j===void 0||(C=j.submit)===null||C===void 0?void 0:C.call(j)},children:"\u63D0\u4EA4"},"submit"),(0,r.jsx)(Z.Z,{type:"dashed",onClick:function(){var j;return(j=R.form)===null||j===void 0?void 0:j.resetFields()},children:"\u91CD\u7F6E"},"rest"),(0,r.jsx)(Z.Z,{type:"dashed",onClick:function(){return a.onCancel()},children:"\u53D6\u6D88"},"cancel")]}},children:[(0,r.jsx)(x.Z,{rules:[{required:!0,message:(0,r.jsx)(g.FormattedMessage,{id:"pages.roleList.ruleName",defaultMessage:"Role name is required"})}],name:"name",placeholder:u.formatMessage({id:"pages.roleList.form.name",defaultMessage:"Role name"}),label:u.formatMessage({id:"pages.roleList.form.name",defaultMessage:"Role name"})}),(0,r.jsx)(I.Z.Item,{name:"verbs",label:u.formatMessage({id:"pages.userList.form.verbs",defaultMessage:"verbs"}),children:(0,r.jsx)(Q.Z,{mode:"multiple",options:t,placeholder:u.formatMessage({id:"pages.roleList.form.verbs.placeholder",defaultMessage:"verbs"})})}),(0,r.jsx)(I.Z.Item,{name:"resources",label:u.formatMessage({id:"pages.roleList.form.resources",defaultMessage:"resources"}),children:(0,r.jsx)(Q.Z,{mode:"multiple",options:c,placeholder:u.formatMessage({id:"pages.roleList.form.resources.placeholder",defaultMessage:"resources"})})})]})})},H=X,ae=function(){var n=h()(l()().mark(function a(u){var t,c,s;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return t=_.ZP.loading("Adding"),f.prev=1,c="role",s="v1",f.next=6,(0,T.v9)(P()(P()({},u),{},{kind:c,apiVersion:s}));case 6:return t(),_.ZP.success("Added successfully"),f.abrupt("return",!0);case 11:return f.prev=11,f.t0=f.catch(1),t(),_.ZP.error("Adding failed, please try again!"),f.abrupt("return",!1);case 16:case"end":return f.stop()}},a,null,[[1,11]])}));return function(u){return n.apply(this,arguments)}}(),Y=function(){var n=h()(l()().mark(function a(u){var t;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=_.ZP.loading("Updating"),s.prev=1,s.next=4,(0,T.vh)({uid:u.uid},u);case 4:return t(),_.ZP.success("Update is successful"),s.abrupt("return",!0);case 9:return s.prev=9,s.t0=s.catch(1),t(),_.ZP.error("Update failed, please try again!"),s.abrupt("return",!1);case 14:case"end":return s.stop()}},a,null,[[1,9]])}));return function(u){return n.apply(this,arguments)}}(),i=function(){var n=h()(l()().mark(function a(u){var t;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t=_.ZP.loading("deleting"),u){s.next=3;break}return s.abrupt("return",!0);case 3:return s.prev=3,s.next=6,(0,T.Fe)({uid:"-"});case 6:return t(),_.ZP.success("Deleted successfully and will refresh soon"),s.abrupt("return",!0);case 11:return s.prev=11,s.t0=s.catch(3),t(),_.ZP.error("Delete failed, please try again"),s.abrupt("return",!1);case 16:case"end":return s.stop()}},a,null,[[3,11]])}));return function(u){return n.apply(this,arguments)}}(),o=function(){var a=(0,L.useState)(!1),u=M()(a,2),t=u[0],c=u[1],s=(0,L.useState)(!1),R=M()(s,2),f=R[0],j=R[1],C=(0,L.useState)(!1),te=M()(C,2),se=te[0],ne=te[1],$=(0,L.useRef)(),de=(0,L.useState)(),le=M()(de,2),E=le[0],z=le[1],ce=(0,L.useState)([]),ue=M()(ce,2),J=ue[0],oe=ue[1],q=(0,g.useIntl)(),ie=[{title:(0,r.jsx)(g.FormattedMessage,{id:"pages.common.uid",defaultMessage:"UID"}),dataIndex:"uid",tip:"The uid is the unique key",render:function(d,p){return(0,r.jsx)("a",{onClick:function(){z(p),ne(!0)},children:d})}},{title:(0,r.jsx)(g.FormattedMessage,{id:"pages.roleList.form.roleName.nameLabel",defaultMessage:"Role name"}),dataIndex:"name"},{title:(0,r.jsx)(g.FormattedMessage,{id:"pages.roleList.form.verbs",defaultMessage:"verbs"}),dataIndex:"verbs",renderText:function(d){return d&&d.join(", ")}},{title:(0,r.jsx)(g.FormattedMessage,{id:"pages.roleList.form.resources",defaultMessage:"resources"}),dataIndex:"resources",renderText:function(d){return d&&d.join(", ")}},{title:(0,r.jsx)(g.FormattedMessage,{id:"pages.roleList.titleCreatedAt",defaultMessage:"Created time"}),sorter:!0,dataIndex:"creationTimestamp",valueType:"dateTime"},{title:(0,r.jsx)(g.FormattedMessage,{id:"pages.common.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(d,p){return[(0,r.jsx)("a",{onClick:function(){j(!0),z(p)},children:(0,r.jsx)(g.FormattedMessage,{id:"pages.roleList.form.roleConfig",defaultMessage:"Configuration"})},"config")]}}];return(0,r.jsxs)(K.ZP,{children:[(0,r.jsx)(y.Z,{headerTitle:q.formatMessage({id:"pages.common.tableTitle",defaultMessage:"Enquiry form"}),actionRef:$,rowKey:"uid",search:{labelWidth:120},toolBarRender:function(){return[(0,r.jsxs)(Z.Z,{type:"primary",onClick:function(){c(!0)},children:[(0,r.jsx)(F.Z,{})," ",(0,r.jsx)(g.FormattedMessage,{id:"pages.common.new",defaultMessage:"New"})]},"primary")]},request:h()(l()().mark(function v(){var d;return l()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,(0,T.Uy)();case 2:return d=b.sent,b.abrupt("return",{data:d.items,success:!0});case 4:case"end":return b.stop()}},v)})),columns:ie,rowSelection:{onChange:function(d,p){oe(p)}}}),(J==null?void 0:J.length)>0&&(0,r.jsx)(S.Z,{extra:(0,r.jsxs)("div",{children:[(0,r.jsx)(g.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,r.jsx)("a",{style:{fontWeight:600},children:J.length})," ",(0,r.jsx)(g.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"})]}),children:(0,r.jsx)(Z.Z,{onClick:h()(l()().mark(function v(){var d,p;return l()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,i(J);case 2:oe([]),(d=$.current)===null||d===void 0||(p=d.reloadAndRest)===null||p===void 0||p.call(d);case 4:case"end":return B.stop()}},v)})),children:(0,r.jsx)(g.FormattedMessage,{id:"pages.common.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,r.jsx)(O.Y,{title:q.formatMessage({id:"pages.roleList.form.newRole",defaultMessage:"New role"}),width:"400px",visible:t,onVisibleChange:c,onFinish:function(){var v=h()(l()().mark(function d(p){var b;return l()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,ae(p);case 2:b=w.sent,b&&(c(!1),$.current&&$.current.reload());case 4:case"end":return w.stop()}},d)}));return function(d){return v.apply(this,arguments)}}(),children:(0,r.jsx)(x.Z,{rules:[{required:!0,message:(0,r.jsx)(g.FormattedMessage,{id:"pages.roleList.ruleName",defaultMessage:"Role name is required"})}],width:"md",name:"name",placeholder:q.formatMessage({id:"pages.roleList.form.name",defaultMessage:"Role name"})})}),(0,r.jsx)(H,{onSubmit:function(){var v=h()(l()().mark(function d(p){var b;return l()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,Y(p);case 2:b=w.sent,b&&(j(!1),z(void 0),$.current&&$.current.reload());case 4:case"end":return w.stop()}},d)}));return function(d){return v.apply(this,arguments)}}(),onCancel:function(){j(!1),se||z(void 0)},updateModalVisible:f,values:E||{}}),(0,r.jsx)(V.Z,{width:600,open:se,onClose:function(){z(void 0),ne(!1)},closable:!1,children:(E==null?void 0:E.uid)&&(0,r.jsx)(k.vY,{column:2,title:E==null?void 0:E.uid,request:h()(l()().mark(function v(){return l()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",{data:E||{}});case 1:case"end":return p.stop()}},v)})),params:{id:E==null?void 0:E.uid},columns:ie})})]})},m=o},53912:function(ee,U,e){e.d(U,{Fe:function(){return L},Uy:function(){return X},v9:function(){return x},vh:function(){return Z}});var A=e(97548),M=e.n(A),W=e(97983),l=e.n(W),G=e(11281),P=e.n(G),D=e(40794),h=e.n(D),T=e(36275),F=null,K=["uid"],y=["uid"],S=null,O=null;function x(i,o){return k.apply(this,arguments)}function k(){return k=h()(l()().mark(function i(o,m){return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,T.request)("/api/apps/v1/role",P()({method:"POST",headers:{"Content-Type":"application/json"},data:o},m||{})));case 1:case"end":return a.stop()}},i)})),k.apply(this,arguments)}function g(i,o){return _.apply(this,arguments)}function _(){return _=_asyncToGenerator(_regeneratorRuntime().mark(function i(o,m){var n,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.uid,a=_objectWithoutProperties(o,F),t.abrupt("return",request("/api/apps/v1/role/".concat(n),_objectSpread({method:"GET",params:_objectSpread({},a)},m||{})));case 2:case"end":return t.stop()}},i)})),_.apply(this,arguments)}function Z(i,o,m){return V.apply(this,arguments)}function V(){return V=h()(l()().mark(function i(o,m,n){var a,u;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=o.uid,u=M()(o,K),c.abrupt("return",(0,T.request)("/api/apps/v1/role/".concat(a),P()({method:"PUT",headers:{"Content-Type":"application/json"},params:P()({},u),data:m},n||{})));case 2:case"end":return c.stop()}},i)})),V.apply(this,arguments)}function L(i,o){return N.apply(this,arguments)}function N(){return N=h()(l()().mark(function i(o,m){var n,a;return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.uid,a=M()(o,y),t.abrupt("return",(0,T.request)("/api/apps/v1/role/".concat(n),P()({method:"DELETE",params:P()({},a)},m||{})));case 2:case"end":return t.stop()}},i)})),N.apply(this,arguments)}function re(i,o,m){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function i(o,m,n){var a,u;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=o.uid,u=_objectWithoutProperties(o,S),c.abrupt("return",request("/api/apps/v1/role/".concat(a),_objectSpread({method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},params:_objectSpread({},u),data:m},n||{})));case 2:case"end":return c.stop()}},i)})),I.apply(this,arguments)}function Q(i,o){return r.apply(this,arguments)}function r(){return r=_asyncToGenerator(_regeneratorRuntime().mark(function i(o,m){var n,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.uid,a=_objectWithoutProperties(o,O),t.abrupt("return",request("/api/apps/v1/role/".concat(n,"/watch"),_objectSpread({method:"GET",params:_objectSpread({},a)},m||{})));case 2:case"end":return t.stop()}},i)})),r.apply(this,arguments)}function X(i){return H.apply(this,arguments)}function H(){return H=h()(l()().mark(function i(o){return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,T.request)("/api/apps/v1/role/list",P()({method:"GET"},o||{})));case 1:case"end":return n.stop()}},i)})),H.apply(this,arguments)}function ae(i){return Y.apply(this,arguments)}function Y(){return Y=_asyncToGenerator(_regeneratorRuntime().mark(function i(o){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/apps/v1/role/watch",_objectSpread({method:"GET"},o||{})));case 1:case"end":return n.stop()}},i)})),Y.apply(this,arguments)}}}]);
